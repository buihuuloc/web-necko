System.register("chunks:///main.js",["cc"],(function(){"use strict";var e,t,n,i,r,o,a,s,l,c,u,h,p,f,d,g,v,y,m,b,I,C,w,R,T,E,S,P,_,A,D,O,N,M,L,k,B,G,F,z,U,x;return{setters:[function(Y){e=Y.cclegacy,t=Y._decorator,n=Y.sys,i=Y.log,r=Y.error,o=Y.resources,a=Y.Prefab,s=Y.instantiate,l=Y.find,c=Y.SpriteFrame,u=Y.isValid,h=Y.assetManager,p=Y.Texture2D,f=Y.assert,d=Y.AudioClip,g=Y.warn,v=Y.clamp01,y=Y.NodePool,m=Y.Node,b=Y.Vec3,I=Y.ParticleSystem,C=Y.RigidBody,w=Y.Collider,R=Y.ERigidBodyType,T=Y.Component,E=Y.Enum,S=Y.macro,P=Y.Label,_=Y.UITransform,A=Y.tween,D=Y.Sprite,O=Y.Animation,N=Y.director,M=Y.Button,L=Y.Color,k=Y.Widget,B=Y.ProgressBarComponent,G=Y.AudioSource,F=Y.game,z=Y.Director,U=Y.Canvas,x=Y.Camera}],execute:function(){function Y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function V(e,t,n){return t&&Y(e.prototype,t),n&&Y(e,n),e}function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function W(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,j(e,t)}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X(e,t,n,i){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(i):void 0})}function K(e,t,n,i,r){var o={};return Object.keys(i).forEach((function(e){o[e]=i[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),o),r&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(r):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var Z,J,Q;e._RF.push({},"05c37maoztIcqYQxP8Afj1j","configuration",void 0);var $=(0,t.ccclass)("configuration")((Q=J=function(){function e(){H(this,"jsonData",null),H(this,"path",null),H(this,"KEY_CONFIG","CarConfig"),H(this,"markSave",!1),H(this,"saveTimer",-1)}var t=e.prototype;return t.start=function(){var e,t=this;(this.jsonData={userId:""},this.path=this.getConfigPath(),n.isNative)?e=jsb.fileUtils.getValueMapFromFile(this.path)[this.KEY_CONFIG]:e=n.localStorage.getItem(this.KEY_CONFIG);if(e&&e.length){e.startsWith("@")&&(e=e.substring(1));try{var i=JSON.parse(e);this.jsonData=i}catch(e){}}this.saveTimer=setInterval((function(){t.scheduleSave()}),500)},t.setConfigDataWithoutSave=function(e,t){var n=this.jsonData.userId;this.jsonData[n]?this.jsonData[n][e]=t:console.error("no account can not save")},t.setConfigData=function(e,t){this.setConfigDataWithoutSave(e,t),this.markSave=!0},t.getConfigData=function(e){var t=this.jsonData.userId;if(this.jsonData[t]){var n=this.jsonData[t][e];return n||""}return i("no account can not load"),""},t.setGlobalData=function(e,t){this.jsonData[e]=t,this.save()},t.getGlobalData=function(e){return this.jsonData[e]},t.setUserId=function(e){this.jsonData.userId=e,this.jsonData[e]||(this.jsonData[e]={}),this.save()},t.getUserId=function(){return this.jsonData.userId},t.scheduleSave=function(){this.markSave&&this.save()},t.markModified=function(){this.markSave=!0},t.save=function(){var e=JSON.stringify(this.jsonData);if(this.markSave=!1,n.isNative){var t={};t[this.KEY_CONFIG]=e,jsb.fileUtils.writeToFile(t,this.path)}else{n.localStorage.setItem(this.KEY_CONFIG,e)}},t.getConfigPath=function(){var e=n.platform,t="";return e===n.OS_WINDOWS?t="src/conf":e===n.OS_LINUX?t="./conf":n.isNative?(t=jsb.fileUtils.getWritablePath(),t+="conf"):t="src/conf",t},t.parseUrl=function(e){if(e&&!("string"==typeof e&&e.length<=0)){var t={};if("string"==typeof e)(e=e.split("?")[1]).split("&").forEach((function(e){var n=e.indexOf("=");if(-1!==n){var i=e.substring(0,n);t[i]=e.substring(n+1)}}));else t=e;t.action&&this.setGlobalData("urlParams",t),t.source&&this.setGlobalData("source",t.source),t.adchannelid&&this.setGlobalData("adchannelid",t.adchannelid)}},e.generateGuestAccount=function(){return""+Date.now()+10},V(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e,this._instance.start()),this._instance}}]),e}(),H(J,"_instance",void 0),Z=Q))||Z;e._RF.pop(),e._RF.push({},"dbe36y+LwBGGIL8I87F3O+/","fightConstants",void 0);var ee,te,ne,ie=function(){};H(ie,"ROAD_POINT_TYPE",{NORMAL:1,START:2,GREETING:3,PLATFORM:4,END:5,AI_START:6}),H(ie,"ROAD_MOVE_TYPE",{LINE:1,BEND:2}),H(ie,"CAR_GROUP",{NORMAL:1,MAIN_CAR:2,OTHER_CAR:4}),H(ie,"CUSTOMER_TALK_TIME",{INTO_THE_CAR:1,NEW_ORDER:2}),H(ie,"CLICK_BOX_REWARD",300),e._RF.pop(),e._RF.push({},"10a25g6TDNP2IICdF4Htopx","oneToMultiListener",void 0);var re,oe,ae,se=(0,t.ccclass)("oneToMultiListener")((ne=te=function(){function e(){}return e.on=function(e,t,n){var i={handler:t,target:n},r=this.handlers[e];r||(r=[],this.handlers[e]=r);for(var o=0;o<r.length;o++)if(!r[o])return r[o]=i,o;return r.push(i),r.length},e.off=function(e,t,n){var i=this.handlers[e];if(i)for(var r=0;r<i.length;r++){var o=i[r];if(o.handler===t&&(!n||n===o.target)){i.splice(r,1);break}}},e.dispatchEvent=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r,o=this.handlers[e];for(r=1;r<arguments.length;r++);if(o)for(r=0;r<o.length;r++){var a=o[r];a.handler&&a.handler.apply(a.target,n)}},e.setSupportEventList=function(e){if(!(e instanceof Array))return r("supportEvent was not array"),!1;for(var t in this.supportEvent={},e){var n=e[t];this.supportEvent[n]=t}return!0},e}(),H(te,"handlers",void 0),H(te,"supportEvent",void 0),ee=ne))||ee;e._RF.pop(),e._RF.push({},"5a305zVBk5GUIdzJLbOwV+H","clientEvent",void 0);var le,ce=t.ccclass,ue=(t.property,ce("clientEvent")((ae=oe=function(e){function t(){return e.apply(this,arguments)||this}return W(t,e),t}(se),H(oe,"handlers",{}),re=ae))||re);e._RF.pop(),e._RF.push({},"aebeeEGJRZGbK315QTzsoll","resourceUtil",void 0);var he=(0,t.ccclass)("resourceUtil")(le=function(){function e(){}return e.loadRes=function(e,t,n){t?o.load(e,t,(function(e,t){if(e)return r(e.message||e),void(n&&n(e,t));n&&n(e,t)})):o.load(e,(function(e,t){if(e)return r(e.message||e),void(n&&n(e,t));n&&n(e,t)}))},e.getMap=function(e,t){var n="map";n+=e>=100?e:e>=10?"0"+e:"00"+e,this.loadRes("gamePackage/map/config/"+n,null,(function(e,n){if(e)t(e,n);else{var i=n,r="";if(i._file){window.LZString&&(r=window.LZString.decompressFromEncodedURIComponent(i._file));var o=JSON.parse(r);t(null,o)}else if(i.text){window.LZString&&(r=window.LZString.decompressFromEncodedURIComponent(i.text));var a=JSON.parse(r);t(null,a)}else if(i.json)t(null,i.json);else{var s=new Error("failed");t(s,null)}}}))},e.getMapObjs=function(e,t,n,i){for(var r=[],s=0;s<t.length;s++)r.push("gamePackage/map/"+e+"/"+t[s]);o.load(r,a,n,i)},e.getUIPrefabRes=function(e,t){this.loadRes("prefab/ui/"+e,a,t)},e.createUI=function(e,t,n){this.getUIPrefabRes(e,(function(e,i){if(!e){var r=s(i);r.setPosition(0,0,0),n||(n=l("Canvas")),n.addChild(r),t&&t(null,r)}}))},e.getCarsBatch=function(e,t,n){for(var i=[],r=0;r<e.length;r++)i.push("prefab/car/car"+e[r]);for(var s=0;s<i.length;s++){var l=i[s];t?o.load(l,a,t,n):o.load(l,a,n)}},e.getUICar=function(e,t){this.loadRes("prefab/ui/car/uiCar"+e,a,t)},e.getCar=function(e,t){this.loadRes("prefab/car/car"+e,a,t)},e.setCarIcon=function(e,t,n,i){var r="gamePackage/texture/car/car"+e;n&&(r+="Black"),this.setSpriteFrame(r,t,i)},e.getJsonData=function(e,t){o.load("datas/"+e,(function(e,n){if(e)r(e.message||e);else{var i=n;if(i.json)t(e,i.json);else{var o=new Error("failed!!!");t(o,null)}}}))},e.getData=function(e,t){o.load("datas/"+e,(function(e,n){if(e)r(e.message||e);else{var i=n.text;i?t(e,i):o.load(n.nativeUrl,(function(e,n){t(e,i=n)}))}}))},e.setSpriteFrame=function(e,t,n){this.loadRes(e+"/spriteFrame",c,(function(i,r){if(i)return console.error("set sprite frame failed! err:",e,i),void n(i,r);t&&u(t)&&(t.spriteFrame=r,n(null,r))}))},e.setRemoteImage=function(e,t,n){if(e&&e.startsWith("http")){h.loadAny([{url:e,type:"png"}],null,(function(t,i){if(t)return console.error("set avatar failed! err:",e,t),void n(t,i);var r=new p;r.image=i;var o=new c;o.texture=r,n&&n(null,o)}))}},e.setGameIcon=function(e,t,n){e.startsWith("http")?this.setRemoteImage(e,t,n):this.setSpriteFrame("gamePackage/textures/icons/games/"+e,t,n)},e.getCustomer=function(e,t){this.loadRes("gamePackage/map/customer/customer"+e,a,t)},e.setCustomerIcon=function(e,t,n){var i="gamePackage/texture/head/head"+e;this.setSpriteFrame(i,t,n)},e.getEffect=function(e,t){this.loadRes("prefab/effect/"+e,a,t)},e}())||le;e._RF.pop(),e._RF.push({},"e478cuMHJdIHa5fP3m5UZ7S","audioManager",void 0);var pe=function(){function e(){H(this,"soundVolume",1)}var t=e.prototype;return t.init=function(t){this.soundVolume=this.getConfiguration(!1)?1:0,e._audioSource=t},t.getConfiguration=function(e){var t;return void 0===(t=e?$.instance.getGlobalData("music"):$.instance.getGlobalData("sound"))||"true"===t},t.playMusic=function(t){var n=e._audioSource;f(n,"AudioManager not inited!"),n.loop=t,n.playing||n.play()},t.playSound=function(t){var n=this,i=e._audioSource;f(i,"AudioManager not inited!");he.loadRes("gamePackage/audio/sound/"+t,d,(function(e,t){e?g("load audioClip failed: ",e):i.playOneShot(t,i.volume?n.soundVolume/i.volume:0)}))},t.setMusicVolume=function(t){var n=e._audioSource;f(n,"AudioManager not inited!"),t=v(t),n.volume=t},t.setSoundVolume=function(e){this.soundVolume=e},t.openMusic=function(){this.setMusicVolume(.8),$.instance.setGlobalData("music","true")},t.closeMusic=function(){this.setMusicVolume(0),$.instance.setGlobalData("music","false")},t.openSound=function(){this.setSoundVolume(1),$.instance.setGlobalData("sound","true")},t.closeSound=function(){this.setSoundVolume(0),$.instance.setGlobalData("sound","false")},V(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}();H(pe,"_instance",void 0),H(pe,"_audioSource",void 0),e._RF.pop(),e._RF.push({},"1ad87mpTDFDV7de0xMwTCq4","constant",void 0);var fe,de,ge,ve=function(){};H(ve,"GAME_NAME","car"),H(ve,"LOCAL_CACHE",{PLAYER:"player",SETTINGS:"settings",DATA_VERSION:"dataVersion",ACCOUNT:"account",HISTORY:"history",BAG:"bag"}),H(ve,"MAX_LEVEL",20),H(ve,"MIN_CAR_ID",101),H(ve,"MAX_CAR_ID",109),H(ve,"AUDIO_SOUND",{BACKGROUND:"background",CRASH:"crash",GET_MONEY:"getMoney",IN_CAR:"inCar",NEW_ORDER:"newOrder",CAR_START:"carStart",WIN:"win",STOP:"stop",TOOTING1:"tooting1",TOOTING2:"tooting2"}),H(ve,"SIGNIN_REWARD_STATUS",{RECEIVED:0,RECEIVABLE:1,UNRECEIVABLE:2,FILL_SIGNIN:3,AFTER_FILL_SIGNIN:4}),H(ve,"MAX_SIGNIN_DAY",7),H(ve,"NORMAL_SHOW_TIME",3),H(ve,"NEWBEE_LEVEL",2),H(ve,"REWARD_TYPE",{DIAMOND:1,GOLD:2,CAR:3}),H(ve,"ONLINE",{MAX_TIME:60,PROFIT_PER_SECOND:.3,TIME_PER_CIRCLE:10}),H(ve,"SHARE_FUNCTION",{BALANCE:"balance",RELIVE:"relive",OFFLINE:"offline",RANK:"rank",LOTTERY:"lottery",LOTTERY_REWARD:"lotteryReward",TRIAL:"trial",CLICK_BOX:"clickBox",ONLINE:"online",SIGNIN:"signIn",FILL_SIGNIN:"fillSignIn",INVINCIBLE:"invincible",SHOP_SHARE:"shopShare",SHOP_VIDEO:"shopVideo"}),H(ve,"INITIAL_CAR",1),H(ve,"BUY_CAR_TYPE",{GOLD:1,LOGIN:2,CONTINUOUS_LOGIN:3,SHARE:4,VIDEO:5,GAME:6,INVITE:7,SIGNIN:8,PASS_LEVEL:9}),H(ve,"OPEN_REWARD_TYPE",{AD:0,SHARE:1,NULL:2}),H(ve,"GOLD_REWARD",{SECOND:500,SEVENT:500}),H(ve,"LOTTERY",{MONEY:2e3,EXCHANGE:500}),H(ve,"CUSTOMER_MAX_CNT",2),H(ve,"MENU_INIT_BOTTOM",40),H(ve,"MENU_BOTTOM",250),e._RF.pop(),e._RF.push({},"907776q4iZNubarZf3Ut3A8","poolManager",void 0);var ye,me,be,Ie,Ce,we,Re,Te,Ee,Se=t.ccclass,Pe=(t.property,Se("poolManager")((ge=de=function(){function e(){H(this,"dictPool",{}),H(this,"dictPrefab",{})}var t=e.prototype;return t.getNode=function(e,t){var n,i=e.data.name;if(this.dictPrefab[i]=e,this.dictPool.hasOwnProperty(i)){var r=this.dictPool[i];n=r.size()>0?r.get():s(e)}else{var o=new y;this.dictPool[i]=o,n=s(e)}return n.parent=t,n},t.putNode=function(e){var t=e.name,n=null;this.dictPool.hasOwnProperty(t)?n=this.dictPool[t]:(n=new y,this.dictPool[t]=n),n.put(e)},t.clearPool=function(e){this.dictPool.hasOwnProperty(e)&&this.dictPool[e].clear()},V(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}(),H(de,"_instance",void 0),fe=ge))||fe);e._RF.pop(),e._RF.push({},"e6d4fVD3pxJ7Y1Khf8fRUoa","car",void 0);var _e,Ae,De,Oe,Ne,Me,Le,ke=t.ccclass,Be=t.property,Ge=(ye=ke("car"),me=Be({displayName:"最大移动速度"}),be=Be({displayName:"最小移动速度"}),Ie=Be(m),ye((Re=K((we=function(e){function t(){var t;return H(q(t=e.call(this)||this),"_isMoving",!1),X(q(t),"maxSpeed",Re,q(t)),X(q(t),"minSpeed",Te,q(t)),X(q(t),"nodeGas",Ee,q(t)),H(q(t),"_minSpeed",-1),H(q(t),"_maxSpeed",-1),H(q(t),"manager",null),H(q(t),"isMain",!1),H(q(t),"currentSpeed",0),H(q(t),"accelerate",2),H(q(t),"originRotation",0),H(q(t),"targetRotation",0),H(q(t),"curRoadPoint",null),H(q(t),"circleCenterPoint",new b),H(q(t),"quarter",0),H(q(t),"_nodeGasInst",null),H(q(t),"entry",null),H(q(t),"forward",new b(0,0,-1)),H(q(t),"posTarget",new b),H(q(t),"posSrc",new b),H(q(t),"_callback",null),H(q(t),"isOver",!1),H(q(t),"curProgress",0),H(q(t),"maxProgress",0),H(q(t),"hasCustomer",!1),H(q(t),"lastPos",new b),H(q(t),"lastRotation",new b),H(q(t),"isBraking",!1),H(q(t),"arrTyres",[]),H(q(t),"curTyreRotation",0),H(q(t),"nodeCarBackLight",null),H(q(t),"tootingCoolTime",0),H(q(t),"isCarMoving",!1),H(q(t),"nodeInvincible",null),H(q(t),"_isHosting",!1),H(q(t),"_isInvincible",!1),H(q(t),"invincibleRotation",0),t}W(t,e);var n=t.prototype;return n.start=function(){var e=this;this._minSpeed=this.minSpeed,this._maxSpeed=this.maxSpeed;var t=this.node.getChildByPath("RootNode/tyre1");t&&(this.arrTyres=[t,this.node.getChildByPath("RootNode/tyre2"),this.node.getChildByPath("RootNode/tyre3"),this.node.getChildByPath("RootNode/tyre4")],this.nodeCarBackLight=this.node.getChildByPath("RootNode/light1")),he.getEffect("gas",(function(t,n){if(!t){var i=Pe.instance.getNode(n,e.nodeGas);e._nodeGasInst=i.getComponent(I),i.setPosition(new b(0,0,0))}}))},n.markMainCar=function(e){this.isMain=e;var t=this.node.getComponent(C),n=this.node.getComponent(w);n.off("onCollisionEnter",this.onCollisionEnter,this),e?(t.setGroup(ie.CAR_GROUP.MAIN_CAR),t.setMask(ie.CAR_GROUP.OTHER_CAR),t.type=R.KINEMATIC,n.on("onCollisionEnter",this.onCollisionEnter,this)):(t.setGroup(ie.CAR_GROUP.OTHER_CAR),t.setMask(-1),t.type=R.DYNAMIC)},n.setEntry=function(e){this.entry=e,this.reset()},n.onCollisionEnter=function(e){var t=this;if(this.isMain&&"ground"!==e.otherCollider.node.name){var n=e.otherCollider.node;e.otherCollider.node===this.node&&(n=e.selfCollider.node);var i=n.getComponent("car");if(!i.isOver){i.isOver=!0;var r=n.getComponent(C);r.useGravity=!0,this.isInvincible?r.applyForce(new b(0,1e4,-3e3),new b(0,.5,0)):r.applyForce(new b(0,1500,-3e3),new b(0,.5,0))}if(!this.isOver){pe.instance.playSound(ve.AUDIO_SOUND.CRASH);var o=this.node.getComponent(C);if(this.isInvincible)return this.lastPos=this.node.worldPosition,this.lastRotation=this.node.eulerAngles,o.enabled=!1,this.scheduleOnce((function(){t.isInvincible=!1,o.enabled=!0,t.revive(),t.currentSpeed=t._minSpeed}),.1),void this.scheduleOnce((function(){Pe.instance.putNode(n)}),.3);this.lastPos=this.node.worldPosition,this.lastRotation=this.node.eulerAngles,this.isOver=!0,o.setGroup(ie.CAR_GROUP.MAIN_CAR),o.setMask(ie.CAR_GROUP.OTHER_CAR|ie.CAR_GROUP.NORMAL),ue.dispatchEvent("gameOver",!1)}}},n.updateBackLight=function(){this.nodeCarBackLight&&(this.nodeCarBackLight.active=!this.isMoving||this.isHosting)},n.startRunning=function(){this.isOver||(this.isMoving=!0,this.accelerate=.4,this._nodeGasInst&&this._nodeGasInst.play(),this.isBraking&&(ue.dispatchEvent("endBraking"),this.isBraking=!1))},n.startWithMinSpeed=function(){this.currentSpeed=this.minSpeed,this.stopRunning(!0),this._nodeGasInst&&this._nodeGasInst.play()},n.stopRunning=function(e){this.isOver||(this.isMoving=!1,this.accelerate=-.15,this.isBraking||e||(ue.dispatchEvent("startBraking"),this.isBraking=!0))},n.stopImmediately=function(){this.isMoving=!1,this.currentSpeed=0},n.setMoveOverListener=function(e){this._callback=e},n.resetPhysical=function(){this.isOver=!1,this.isMain&&this.markMainCar(!0);var e=this.node.getComponent(C);e.useGravity=!1,e.sleep(),e.wakeUp()},n.revive=function(){this.resetPhysical(),console.log("revive pos ",this.lastPos);var e=new b(this.lastPos.x,0,this.lastPos.z);this.node.setWorldPosition(e),this.node.eulerAngles=this.lastRotation,this.isMoving=!1,this.currentSpeed=0},n.reset=function(){this.resetPhysical(),this.isMain&&(this.curProgress=0,this.hasCustomer=!1,this._nodeGasInst&&this._nodeGasInst.stop(),this.isInvincible=!1),this.tootingCoolTime=0,this.curRoadPoint=this.entry.getComponent("roadPoint"),this.posSrc.set(this.entry.worldPosition),this.posTarget.set(this.curRoadPoint.next.worldPosition),this.node.setWorldPosition(this.entry.worldPosition),this.posTarget.z!==this.posSrc.z?this.posTarget.z<this.posSrc.z?this.node.eulerAngles=new b(0,360,0):this.node.eulerAngles=new b(0,180,0):this.posTarget.x>this.posSrc.x?this.node.eulerAngles=new b(0,270,0):this.node.eulerAngles=new b(0,90,0),this.originRotation=this.node.eulerAngles.y,this.targetRotation=this.originRotation,this.isMoving=!1,this.isHosting=!1,this.currentSpeed=0,this._minSpeed>0&&(this.minSpeed=this._minSpeed,this.maxSpeed=this._maxSpeed)},n.greeting=function(){var e=this;this.isHosting=!0,this.curProgress++,this.hasCustomer=!0,ue.dispatchEvent("greetingCustomer"),this.manager.greeting(this.node.worldPosition,this.curRoadPoint.direction,(function(){e.isMoving=!1,e.currentSpeed=0,e.isHosting=!1,ue.dispatchEvent("showGuide",!0)}))},n.takeCustomer=function(){var e=this;this.isHosting=!0,this.hasCustomer=!1,ue.dispatchEvent("takeCustomer"),this.manager.takeCustomer(this.node.worldPosition,this.curRoadPoint.direction,this.curProgress===this.maxProgress,(function(){e.isMoving=!1,e.currentSpeed=0,e.isHosting=!1,ue.dispatchEvent("showGuide",!0)}))},n.arrivalPoint=function(){if(this.node.setWorldPosition(this.posTarget),this.curRoadPoint.moveType===ie.ROAD_MOVE_TYPE.BEND&&(this.node.eulerAngles=new b(0,this.targetRotation,0)),this.posSrc.set(this.posTarget),this.posTarget.set(b.ZERO),this.curRoadPoint.next){if(this.curRoadPoint=this.curRoadPoint.next.getComponent("roadPoint"),this.isMain&&(this.curRoadPoint.type===ie.ROAD_POINT_TYPE.GREETING?this.greeting():this.curRoadPoint.type===ie.ROAD_POINT_TYPE.PLATFORM?this.takeCustomer():this.curRoadPoint.type===ie.ROAD_POINT_TYPE.END&&(ue.dispatchEvent("gameOver",!0),this.moveAfterFinished())),this.curRoadPoint.next?this.posTarget.set(this.curRoadPoint.next.worldPosition):this._callback&&this._callback(this),this.originRotation=this.node.eulerAngles.y,this.targetRotation=this.originRotation,this.curRoadPoint.moveType===ie.ROAD_MOVE_TYPE.BEND){if(this.curRoadPoint.clockwise){this.originRotation=this.originRotation<=0?360+this.originRotation:this.originRotation,this.targetRotation=this.originRotation-90,this.posTarget.x>this.posSrc.x&&this.posTarget.z<this.posSrc.z||this.posTarget.x<this.posSrc.x&&this.posTarget.z>this.posSrc.z?this.circleCenterPoint=new b(this.posTarget.x,0,this.posSrc.z):this.circleCenterPoint=new b(this.posSrc.x,0,this.posTarget.z);var e=b.subtract(new b,this.circleCenterPoint,this.posSrc).length();this.quarter=90/(Math.PI*e/2)}else{this.originRotation=this.originRotation>=360?this.originRotation-360:this.originRotation,this.targetRotation=this.originRotation+90,this.posTarget.x>this.posSrc.x&&this.posTarget.z<this.posSrc.z||this.posTarget.x<this.posSrc.x&&this.posTarget.z>this.posSrc.z?this.circleCenterPoint=new b(this.posSrc.x,0,this.posTarget.z):this.circleCenterPoint=new b(this.posTarget.x,0,this.posSrc.z);var t=b.subtract(new b,this.circleCenterPoint,this.posSrc).length();this.quarter=90/(Math.PI*t/2)}this.node.eulerAngles=new b(0,this.originRotation,0)}}else this.curRoadPoint=null,this._callback&&this._callback(this)},n.update=function(e){if(this.nodeInvincible&&(this.invincibleRotation+=200*e,this.invincibleRotation>360&&(this.invincibleRotation-=360),this.nodeInvincible.eulerAngles=new b(this.invincibleRotation,0,0)),this.tootingCoolTime>0&&(this.tootingCoolTime=this.tootingCoolTime>e?this.tootingCoolTime-e:0),!this.isMoving&&this.currentSpeed<.01||this.posTarget.equals(b.ZERO)||this.isHosting||this.isOver)this.isCarMoving=!1;else{if(this.isCarMoving=!0,this.currentSpeed+=this.accelerate*e,this.currentSpeed=this.currentSpeed>this.maxSpeed?this.maxSpeed:this.currentSpeed,this.currentSpeed<this.minSpeed&&(this.currentSpeed=this.minSpeed,this.isBraking&&(ue.dispatchEvent("endBraking"),this.isBraking=!1)),this.arrTyres.length>0){this.curTyreRotation-=200*this.currentSpeed,this.curTyreRotation<-360&&(this.curTyreRotation+=360);for(var t=new b(this.curTyreRotation,0),n=0;n<this.arrTyres.length;n++){this.arrTyres[n].eulerAngles=t}}switch(this.curRoadPoint.moveType){case ie.ROAD_MOVE_TYPE.LINE:var i=new b;b.subtract(i,this.posTarget,this.node.worldPosition),i.normalize(),b.multiplyScalar(i,i,this.currentSpeed);var r=this.node.worldPosition;i.add(r),this.posTarget.z!==this.posSrc.z?this.posTarget.z<this.posSrc.z?(this.node.eulerAngles=new b(0,360,0),i.z<this.posTarget.z&&(i.z=this.posTarget.z)):(this.node.eulerAngles=new b(0,180,0),i.z>this.posTarget.z&&(i.z=this.posTarget.z)):this.posTarget.x>this.posSrc.x?(this.node.eulerAngles=new b(0,270,0),i.x>this.posTarget.x&&(i.x=this.posTarget.x)):(this.node.eulerAngles=new b(0,90,0),i.x<this.posTarget.x&&(i.x=this.posTarget.x)),this.node.setWorldPosition(i);break;case ie.ROAD_MOVE_TYPE.BEND:var o=this.targetRotation-this.originRotation,a=this.node.eulerAngles.y<0?360+this.node.eulerAngles.y:this.node.eulerAngles.y;this.node.eulerAngles.y>360&&(a=this.node.eulerAngles.y-360);var s=o*Math.abs((a-this.originRotation)/o)+this.currentSpeed*this.quarter*(this.targetRotation>this.originRotation?1:-1);Math.abs(o)<Math.abs(s)&&(s=o);var l=this.originRotation+s,c=b.rotateY(new b,this.posSrc,this.circleCenterPoint,s*Math.PI/180);this.node.setWorldPosition(c),this.node.eulerAngles=new b(0,l,0)}b.subtract(new b,this.posTarget,this.node.worldPosition).lengthSqr()<.001&&this.arrivalPoint()}},n.moveAfterFinished=function(){this.isMoving=!0,this.minSpeed=.2,this.maxSpeed=.2,this.startRunning()},n.tooting=function(){if(!(this.tootingCoolTime>0)){this.tootingCoolTime=5;var e=1===Math.floor(2*Math.random())?ve.AUDIO_SOUND.TOOTING1:ve.AUDIO_SOUND.TOOTING2;pe.instance.playSound(e)}},V(t,[{key:"isMoving",get:function(){return this._isMoving},set:function(e){this._isMoving=e,this.updateBackLight()}},{key:"isHosting",get:function(){return this._isHosting},set:function(e){this._isHosting=e,this.updateBackLight()}},{key:"isInvincible",get:function(){return this._isInvincible},set:function(e){var t=this;if(this._isInvincible=e,e){if(this.nodeInvincible)return void(this.nodeInvincible.active=!0);he.getEffect("shield",(function(e,n){e?console.error(e):(t.nodeInvincible=s(n),t.nodeInvincible.parent=t.node)}))}else this.nodeInvincible&&(this.nodeInvincible.destroy(),this.nodeInvincible=null)}}]),t}(T)).prototype,"maxSpeed",[me],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),Te=K(we.prototype,"minSpeed",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),Ee=K(we.prototype,"nodeGas",[Ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ce=we))||Ce);e._RF.pop(),e._RF.push({},"ff8ee6OQldPNLrgLpXROotm","follow",void 0);var Fe,ze,Ue,xe,Ye,Ve,He,We,je,qe,Xe,Ke,Ze,Je,Qe,$e,et,tt,nt,it,rt,ot=t.ccclass,at=t.property,st=(_e=ot("follow"),Ae=at({type:m}),_e((Ne=K((Oe=function(e){function t(){var t;return X(q(t=e.call(this)||this),"followTarget",Ne,q(t)),X(q(t),"isFollowRotation",Me,q(t)),X(q(t),"offset",Le,q(t)),H(q(t),"moveSpeed",3),H(q(t),"isPlayingStart",!1),t}W(t,e);var n=t.prototype;return n.start=function(){},n.showStart=function(){},n.lateUpdate=function(e){if(this.followTarget){var t=this.node.worldPosition;if(this.isPlayingStart){var n=new b(this.followTarget.worldPosition.x+this.offset.x,this.followTarget.worldPosition.y+this.offset.y,this.followTarget.worldPosition.z+this.offset.z);b.subtract(new b,t,n).length()>.001&&b.lerp(n,t,n,this.moveSpeed*e),this.node.setWorldPosition(n),this.node.lookAt(this.followTarget.worldPosition,new b(0,1,0))}else{var i=this.offset;this.isFollowRotation&&(i=b.transformQuat(new b,this.offset,this.followTarget.rotation));var r=new b(this.followTarget.worldPosition.x+i.x,this.followTarget.worldPosition.y+i.y,this.followTarget.worldPosition.z+i.z);if(this.node.setWorldPosition(r),this.node.lookAt(this.followTarget.worldPosition,new b(0,1,0)),this.isFollowRotation){var o=new b(this.node.eulerAngles);o.y=this.followTarget.eulerAngles.y,this.node.eulerAngles=o}}}},t}(T)).prototype,"followTarget",[Ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Me=K(Oe.prototype,"isFollowRotation",[at],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Le=K(Oe.prototype,"offset",[at],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new b}}),De=Oe))||De);e._RF.pop(),e._RF.push({},"953fazcJb1LuJlDQlkFCkFG","roadPoint",void 0);var lt,ct,ut=t.ccclass,ht=t.property;!function(e){e[e["普通节点"]=ie.ROAD_POINT_TYPE.NORMAL]="普通节点",e[e["开始节点"]=ie.ROAD_POINT_TYPE.START]="开始节点",e[e["接客节点"]=ie.ROAD_POINT_TYPE.GREETING]="接客节点",e[e["送客节点"]=ie.ROAD_POINT_TYPE.PLATFORM]="送客节点",e[e["结束节点"]=ie.ROAD_POINT_TYPE.END]="结束节点",e[e["AI开始节点"]=ie.ROAD_POINT_TYPE.AI_START]="AI开始节点"}(lt||(lt={})),E(lt),function(e){e[e["直线行走"]=ie.ROAD_MOVE_TYPE.LINE]="直线行走",e[e["曲线行走"]=ie.ROAD_MOVE_TYPE.BEND]="曲线行走"}(ct||(ct={})),E(ct);var pt,ft=(Fe=ut("roadPoint"),ze=ht({displayName:"类型",type:lt,displayOrder:1}),Ue=ht({displayName:"下一站",type:m,displayOrder:2}),xe=ht({displayName:"行走方式",type:ct,displayOrder:3}),Ye=ht({displayName:"顺时针",displayOrder:4,visible:function(){return this.moveType===ie.ROAD_MOVE_TYPE.BEND}}),Ve=ht({displayName:"顾客方向",displayOrder:4,visible:function(){return this.type===ie.ROAD_POINT_TYPE.GREETING||this.type===ie.ROAD_POINT_TYPE.PLATFORM}}),He=ht({displayName:"延迟生成/秒",displayOrder:5,visible:function(){return this.type===ie.ROAD_POINT_TYPE.AI_START}}),We=ht({displayName:"生成频率/秒",displayOrder:5,visible:function(){return this.type===ie.ROAD_POINT_TYPE.AI_START}}),je=ht({displayName:"车辆行驶速度",displayOrder:5,visible:function(){return this.type===ie.ROAD_POINT_TYPE.AI_START}}),qe=ht({displayName:"产生车辆(,分隔)",displayOrder:5,visible:function(){return this.type===ie.ROAD_POINT_TYPE.AI_START}}),Fe((Ze=K((Ke=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"type",Ze,q(t)),X(q(t),"next",Je,q(t)),X(q(t),"moveType",Qe,q(t)),X(q(t),"clockwise",$e,q(t)),X(q(t),"direction",et,q(t)),X(q(t),"delayTime",tt,q(t)),X(q(t),"genInterval",nt,q(t)),X(q(t),"carSpeed",it,q(t)),X(q(t),"cars",rt,q(t)),H(q(t),"arrCars",[]),H(q(t),"_generateCb",null),t}W(t,e);var n=t.prototype;return n.start=function(){this.arrCars=this.cars.split(",")},n.startGenerateCar=function(e){this.type===ie.ROAD_POINT_TYPE.AI_START&&(this._generateCb=e,this.stopGenerateCar(),this.scheduleOnce(this.delayStartGen,this.delayTime),he.getCarsBatch(this.arrCars,(function(){}),(function(){})))},n.delayStartGen=function(){this.scheduleGen(),this.schedule(this.scheduleGen,this.genInterval,S.REPEAT_FOREVER)},n.scheduleGen=function(){var e=Math.floor(Math.random()*this.arrCars.length);this._generateCb&&this._generateCb(this,this.arrCars[e])},n.stopGenerateCar=function(){this.unschedule(this.delayStartGen),this.unschedule(this.scheduleGen)},t}(T)).prototype,"type",[ze],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return lt.普通节点}}),Je=K(Ke.prototype,"next",[Ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qe=K(Ke.prototype,"moveType",[xe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ct.直线行走}}),$e=K(Ke.prototype,"clockwise",[Ye],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),et=K(Ke.prototype,"direction",[Ve],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new b}}),tt=K(Ke.prototype,"delayTime",[He],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),nt=K(Ke.prototype,"genInterval",[We],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),it=K(Ke.prototype,"carSpeed",[je],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.05}}),rt=K(Ke.prototype,"cars",[qe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"201"}}),Xe=Ke))||Xe);e._RF.pop(),e._RF.push({},"f1bcdp9t1BPdo0rL87xRyba","util",void 0);var dt,gt=t.ccclass,vt=(t.property,gt("util")(pt=function(){function e(){}return e.clone=function(e){if(null===e||"object"!=typeof e)return e;var t={};for(var n in e.constructor===Array&&(t=[]),e)e.hasOwnProperty(n)&&(t[n]=this.clone(e[n]));return t},e.objectToArray=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},e.arrayToObject=function(e,t){var n={};for(var i in e)e.hasOwnProperty(i)&&e[i][t]&&(n[e[i][t]]=e[i]);return n},e.getWeightRandIndex=function(e,t){for(var n=Math.floor(Math.random()*t),i=0,r=0;r<e.length&&!(n<(i+=e[r]));r++);return r},e.getRandomNFromM=function(e,t){for(var n=[],i=0,r=0;r<t&&!(r>=e+1);){i=this.getRandomInt(0,e);for(var o=0,a=0;a<r;a++)if(n[a]===i){o=1;break}0===o&&(n[r]=i,r++)}return n},e.getRandomInt=function(e,t){var n=Math.random()*(t-e+1)+e;return Math.floor(n)},e.getStringLength=function(e){for(var t=e,n=0,i=0,r=t.length;i<r;i++){n+=t.charCodeAt(i)<=255?1:2}return Math.ceil(n/2)},e.isEmptyObject=function(e){var t=!0;if(e&&e.constructor===Object){for(var n in e)if(e.hasOwnProperty(n)){t=!1;break}}else t=!1;return t},e.formatNum=function(e){if(e<=0)return"0";var t=Math.round(Math.log(e)/Math.log(1e3));return parseInt((e/Math.pow(1e3,t-1<0?0:t-1)).toString(),10)+["","","K","M","B"][t]},e.isNewDay=function(e){var t=new Date(e),n=new Date,i=t.getFullYear(),r=t.getMonth(),o=t.getDate(),a=n.getFullYear(),s=n.getMonth(),l=n.getDate();return a>i||(s>r||l>o)},e.getPropertyCount=function(e){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n},e.difference=function(e,t){var n=[];if(e.constructor!==Array||t.constructor!==Array)return n;for(var i=e.length,r=0;r<i;r++)-1===t.indexOf(e[r])&&n.push(e[r]);return n},e.simulationUUID=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},e.trim=function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},e.isNowValid=function(e,t){var n=new Date(e),i=new Date(t),r=!1;if(n.getDate()+""!="NaN"&&i.getDate()+""!="NaN"){var o=new Date;r=o<i&&o>n}return r},e.getDeltaDays=function(e,t){var n=new Date(e),i=new Date(t),r=n.getFullYear(),o=n.getMonth()+1,a=n.getDate(),s=i.getFullYear(),l=i.getMonth()+1,c=i.getDate();e=new Date(r+"/"+o+"/"+a+" GMT+0800").getTime();var u=(t=new Date(s+"/"+l+"/"+c+" GMT+0800").getTime())-e;return Math.floor(u/864e5)},e.getMin=function(e){var t=0;if(e.constructor===Array)for(var n=e.length,i=0;i<n;i++)t=0===i?Number(e[0]):t>Number(e[i])?Number(e[i]):t;return t},e.formatTwoDigits=function(e){return(Array(2).join("0")+e).slice(-2)},e.formatDate=function(e,t){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var i in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?""+n[i]:("00"+n[i]).substr((""+n[i]).length)));return t},e.getDay=function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},e.formatMoney=function(e){for(var t=["","K","M","G","T","P","E","Z","Y","B","N","D"],n="",i=0;i<t.length;i++){if(!(e>=1e4)){n=Math.floor(e)+t[i];break}e/=1e3}return""===n&&(n=Math.floor(e)+"U"),n},e.formatTimeForSecond=function(e){var t="",n=e%60,i=Math.floor(e/60);i=i<0?0:i;var r=Math.floor(i/60),o=i%60;return r>0&&(t+=r>9?r.toString():"0"+r,t+=":"),t+=o>9?o.toString():"0"+o,t+=":",t+=n>9?n.toString():"0"+n},e.formatTimeForMillisecond=function(e){var t=Math.floor(e/1e3%60),n=Math.floor(e/1e3/60%60),i=Math.floor(e/1e3/60/60);return(t<10?"0"+t:t)+":"+(n<10?"0"+n:n)+":"+(i<10?"0"+i:i)},e.zip=function(e){var t=pako.gzip(encodeURIComponent(e),{to:"string"});return this.base64encode(t)},e.rand=function(e){for(var t=this.clone(e),n=t.length-1;n>=0;n--){var i=Math.floor(Math.random()*(n+1)),r=t[i];t[i]=t[n],t[n]=r}return t},e}())||pt);e._RF.pop(),e._RF.push({},"64d5aR01mZIArZ14oqSxdz0","csvManager",void 0);var yt,mt,bt,It=t.ccclass,Ct=[",",";","\t","|","^"],wt=["\r\n","\r","\n"],Rt=function(e,t,n,i){return n instanceof Array?"number"===n[t]?Number(i[t]):"boolean"===n[t]?"true"===i[t]||"t"===i[t]||"1"===i[t]:i[t]:isNaN(Number(e))?"false"==e||"true"==e||"t"==e||"f"==e?"true"===i[t]||"t"===i[t]||"1"===i[t]:i[t]:Number(i[t])},Tt={STANDARD_DECODE_OPTS:{skip:0,limit:!1,header:!1,cast:!1,comment:""},STANDARD_ENCODE_OPTS:{delimiter:Ct[0],newline:wt[0],skip:0,limit:!1,header:!1},quoteMark:'"',doubleQuoteMark:'""',quoteRegex:/"/g,opts:{},assign:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Array.prototype.slice.call(arguments);for(var i=t[0],r=t.slice(1),o=0,a=r.length;o<a;o++)for(var s in r[o])i[s]=r[o][s];return i},map:function(e,t){for(var n=[],i=0,r=e.length;i<r;i++)n[i]=t(e[i],i);return n},getType:function(e){return Object.prototype.toString.call(e).slice(8,-1)},getLimit:function(e,t){return!1===e?t:1},buildObjectConstructor:function(e,t,n){return function(i){var r={},o=function(e,t){return r[e]=t};return n?e.forEach((function(e,r){o(e,Rt(t[r],r,n,i))})):e.forEach((function(e,n){o(e,Rt(t[n],n,null,i))})),r}},buildArrayConstructor:function(e,t,n){return function(i){var r=new Array(t.length),o=function(e,t){return r[e]=t};return n?e.forEach((function(e,r){o(e,Rt(t[r],r,n,i))})):e.forEach((function(e,n){o(e,Rt(t[n],n,null,i))})),r}},frequency:function(e,t,n){void 0===n&&(n=!1);for(var i=0,r=0,o=this.getLimit(n,e.length);r<o&&-1!==(r=e.indexOf(t,r));)r+=1,i++;return i},mostFrequent:function(e,t,n){for(var i="",r=t.length-1;r>=0;r--)this.frequency(e,t[r],n)>0&&(i=t[r]);return i||t[0]},unsafeParse:function(e,t,n){var i,r,o=e.split(t.newline);function a(e){var n=e.shift();if(n.indexOf('"')>=0){for(var i=0,r=0,o=0;e.length>0&&(-1!==(i=n.indexOf('"',r))||o%2!=0);)-1!==i?(r=i+1,o++):n=n+t.newline+e.shift();var a,s=[],l=0,c=0,u=0,h=n.length;for(var p in n)if(n.hasOwnProperty(p)){var f=parseInt(p),d=n[p];0===f&&'"'===d&&(l++,c=1),'"'===d&&(l++,n[f-1]===t.delimiter&&c===f&&c++),'"'===d&&l%2==0&&(n[f+1]!==t.delimiter&&f+1!==h||(u=f,a=n.substring(c,u),s.push(a),u=c=u+2)),d===t.delimiter&&l%2==0&&((u=f)>c?(a=n.substring(c,u),s.push(a),u=c=u+1):u===c&&(s.push(""),u=c=u+1))}return(u=h)>=c&&(a=n.substring(c,u),s.push(a)),s}return n.split(t.delimiter)}for(t.skip>0&&o.splice(t.skip),t.header?(!0===t.header?(t.comment=a(o),t.cast=a(o),i=a(o)):"Array"===this.getType(t.header)&&(i=t.header),r=this.buildObjectConstructor(i,o[0].split(t.delimiter),t.cast)):r=this.buildArrayConstructor(i,o[0].split(t.delimiter),t.cast);o.length>0;){var s=a(o);s.length>1&&n(r(s),i[0])}return!0},safeParse:function(e,t){var n=t.newline,i=e.split(n);return t.skip>0&&i.splice(t.skip),!0},encodeCells:function(e,t,n){for(var i=e.slice(0),r=0,o=i.length;r<o;r++)-1!==i[r].indexOf(this.quoteMark)&&(i[r]=i[r].replace(this.quoteRegex,this.doubleQuoteMark)),-1===i[r].indexOf(t)&&-1===i[r].indexOf(n)||(i[r]=this.quoteMark+i[r]+this.quoteMark);return i.join(t)},encodeArrays:function(e,t,n){var i=t.delimiter,r=t.newline;t.header&&"Array"===this.getType(t.header)&&n(this.encodeCells(t.header,i,r));for(var o=0,a=this.getLimit(t.limit,e.length);o<a;o++)n(this.encodeCells(e[o],i,r));return!0},encodeObjects:function(e,t,n){var i=t.delimiter,r=t.newline,o=[],a=[];for(var s in e[0])o.push(s),a.push(e[0][s]);!0===t.header?n(this.encodeCells(o,i,r)):"Array"===this.getType(t.header)&&n(this.encodeCells(t.header,i,r)),n(this.encodeCells(a,i,"\n"));for(var l=1,c=this.getLimit(t.limit,e.length);l<c;l++){a=[];for(var u=0,h=o.length;u<h;u++)a.push(e[l][o[u]]);n(this.encodeCells(a,i,r))}return!0},parse:function(e,t,n){var i=[];if("Function"===this.getType(t)?(n=t,t={}):"Function"!==this.getType(n)&&(n=i.push.bind(i)),t=this.assign({},this.STANDARD_DECODE_OPTS,t),this.opts=t,!t.delimiter||!t.newline){var r=Math.min(48,Math.floor(e.length/20),e.length);t.delimiter=t.delimiter||this.mostFrequent(e,Ct,0!==r),t.newline=t.newline||this.mostFrequent(e,wt,0!==r)}return this.unsafeParse(e,t,n)&&(!(i.length>0)||i)},encode:function(e,t,n){var i=[];return"Function"===this.getType(t)?n=t:"Function"!==this.getType(n)&&(n=(i=[]).push.bind(i)),(t=this.assign({},this.STANDARD_ENCODE_OPTS,t)).skip>0&&(e=e.slice(t.skip)),("Array"===this.getType(e[0])?this.encodeArrays:this.encodeObjects)(e,t,n)&&(!(i.length>0)||i.join(t.newline))}},Et=It("csvManager")(dt=function(){function e(){H(this,"csvTables",{}),H(this,"csvTableForArr",{}),H(this,"tableCast",{}),H(this,"tableComment",{})}var t=e.prototype;return t.addTable=function(e,t,n){if(!this.csvTables[e]||n){var i={},r=[];Tt.parse(t,{header:!0},(function(e,t){i[e[t]]=e,r.push(e)})),this.tableCast[e]=Tt.opts.cast,this.tableComment[e]=Tt.opts.comment,this.csvTables[e]=i,this.csvTableForArr[e]=r}},t.getTableArr=function(e){return this.csvTableForArr[e]},t.getTable=function(e){return this.csvTables[e]},t.queryOne=function(e,t,n){var i=this.getTable(e);if(!i)return null;if(!t)return i[n];for(var r in i)if(i.hasOwnProperty(r)&&i[r][t]===n)return i[r]},t.queryByID=function(e,t){return this.queryOne(e,null,t)},t.queryAll=function(e,t,n){var i=this.getTable(e);if(!i||!t)return null;var r={};for(var o in i)i.hasOwnProperty(o)&&i[o][t]===n&&(r[o]=i[o]);return r},t.queryIn=function(e,t,n){var i=this.getTable(e);if(!i||!t)return null;for(var r={},o=Object.keys(i),a=o.length,s=0;s<a;s++){var l=i[o[s]];n.indexOf(l[t])>-1&&(r[o[s]]=l)}return r},t.queryByCondition=function(e,t){if(t.constructor!==Object)return null;var n=this.getTable(e);if(!n)return null;for(var i={},r=Object.keys(n),o=r.length,a=Object.keys(t),s=a.length,l=0;l<o;l++){for(var c=n[r[l]],u=!0,h=0;h<s;h++){var p=a[h];u=u&&t[p].indexOf(c[p])>-1&&!i[r[l]]}u&&(i[r[l]]=c)}return i},e}())||dt;e._RF.pop(),e._RF.push({},"acd0cVlaIhLurmAIUS/N+2B","localConfig",void 0);var St,Pt,_t,At=t.ccclass,Dt=(t.property,At("localConfig")((bt=mt=function(){function e(){H(this,"csvManager",null),H(this,"arrCars",[]),H(this,"_callback",null),H(this,"_skills",{}),H(this,"currentLoad",0),H(this,"cntLoad",0),H(this,"servers",[])}var t=e.prototype;return t.loadConfig=function(e){this._callback=e,this.csvManager=new Et,this.loadCSV()},t.loadCSV=function(){var e=this,t=["talk","car","signIn"];this.cntLoad=t.length+1,t.forEach((function(t,n,i){he.getData(t,(function(n,i){e.csvManager.addTable(t,i),e.tryToCallbackOnFinished()}))})),he.getJsonData("servers",(function(t,n){e.servers=n,e.tryToCallbackOnFinished()}))},t.queryOne=function(e,t,n){return this.csvManager.queryOne(e,t,n)},t.queryByID=function(e,t){return this.csvManager.queryByID(e,t)},t.getTable=function(e){return this.csvManager.getTable(e)},t.getTableArr=function(e){return this.csvManager.getTableArr(e)},t.getCars=function(){if(this.arrCars.length>0)return this.arrCars;var t=e.instance.getTableArr("car");return this.arrCars=t.sort((function(e,t){return e.sort-t.sort})),this.arrCars},t.queryAll=function(e,t,n){return this.csvManager.queryAll(e,t,n)},t.queryIn=function(e,t,n){return this.csvManager.queryIn(e,t,n)},t.queryByCondition=function(e,t){return this.csvManager.queryByCondition(e,t)},t.tryToCallbackOnFinished=function(){this._callback&&(this.currentLoad++,this.currentLoad>=this.cntLoad&&this._callback())},t.getCurrentServer=function(){return this.servers[0]},t.getVersion=function(){var e=this.getCurrentServer();return e?e.version:"unknown"},V(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}(),H(mt,"_instance",void 0),yt=bt))||yt);e._RF.pop(),e._RF.push({},"985d59n5DNIrIcY9mIscZXN","playerData",void 0);var Ot,Nt,Mt,Lt,kt,Bt=t.ccclass,Gt=(t.property,Bt("playerData")((_t=Pt=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return H(q(t=e.call.apply(e,[this].concat(i))||this),"serverTime",0),H(q(t),"localTime",0),H(q(t),"showCar",0),H(q(t),"isComeFromBalance",!1),H(q(t),"userId",""),H(q(t),"playerInfo",{}),H(q(t),"history",null),H(q(t),"settings",null),H(q(t),"isNewBee",!1),H(q(t),"dataVersion",""),H(q(t),"signInInfo",null),t}W(t,e);var n=t.prototype;return n.loadGlobalCache=function(){var e=$.instance.getUserId();e&&(this.userId=e)},n.loadFromCache=function(){this.playerInfo=this.loadDataByKey(ve.LOCAL_CACHE.PLAYER),this.playerInfo.currentCar?this.showCar=this.playerInfo.currentCar:this.showCar=ve.INITIAL_CAR,this.history=this.loadDataByKey(ve.LOCAL_CACHE.HISTORY),this.settings=this.loadDataByKey(ve.LOCAL_CACHE.SETTINGS)},n.loadDataByKey=function(e){var t={},n=$.instance.getConfigData(e);if(n)try{t=JSON.parse(n)}catch(e){t={}}return t},n.createPlayerInfo=function(e){if(this.playerInfo.level=1,this.playerInfo.realLevel=1,this.playerInfo.passCheckPoint=!1,this.playerInfo.createDate=new Date,this.playerInfo.currentCar=ve.INITIAL_CAR,this.playerInfo.cars=[],this.playerInfo.cars.push(ve.INITIAL_CAR),this.playerInfo.dictBuyTask={},this.showCar=this.playerInfo.currentCar,this.isNewBee=!0,this.playerInfo.signInInfo={},this.playerInfo.dictGetCarTime={},e)for(var t in e)this.playerInfo[t]=e[t];this.savePlayerInfoToLocalCache()},n.saveAccount=function(e){this.userId=e,$.instance.setUserId(e)},n.savePlayerInfoToLocalCache=function(){$.instance.setConfigData(ve.LOCAL_CACHE.PLAYER,JSON.stringify(this.playerInfo))},n.saveAll=function(){$.instance.setConfigDataWithoutSave(ve.LOCAL_CACHE.PLAYER,JSON.stringify(this.playerInfo)),$.instance.setConfigDataWithoutSave(ve.LOCAL_CACHE.HISTORY,JSON.stringify(this.history)),$.instance.setConfigDataWithoutSave(ve.LOCAL_CACHE.SETTINGS,JSON.stringify(this.settings)),$.instance.setConfigData(ve.LOCAL_CACHE.DATA_VERSION,this.dataVersion)},n.updatePlayerInfo=function(e,t){var n=!1;this.playerInfo.hasOwnProperty(e)&&("number"==typeof t?(n=!0,this.playerInfo[e]+=t,this.playerInfo[e]<0&&(this.playerInfo[e]=0)):"boolean"!=typeof t&&"string"!=typeof t||(n=!0,this.playerInfo[e]=t)),n&&$.instance.setConfigData(ve.LOCAL_CACHE.PLAYER,JSON.stringify(this.playerInfo))},n.updateSignInCurrentDay=function(){if(0===Object.keys(this.playerInfo.signInInfo).length||this.isNeedRecycleSignInInfo())this.createNewSignInInfo();else{var e=vt.getDeltaDays(this.playerInfo.signInInfo.signInDate,Date.now());if(0===e)return;this.updateSignInFillSignInDays(0,!0),this.playerInfo.signInInfo.currentDay+=e,this.playerInfo.signInInfo.currentDay<=0&&this.createNewSignInInfo(),this.playerInfo.signInInfo.currentDay>ve.MAX_SIGNIN_DAY||this.playerInfo.signInInfo.currentDay,this.playerInfo.signInInfo.signInDate=Date.now()}this.savePlayerInfoToLocalCache()},n.createNewSignInInfo=function(){this.playerInfo.hasOwnProperty("signInInfo")||(this.playerInfo.signInInfo={},this.playerInfo.dictGetCarTime={});var e=this.playerInfo.signInInfo;e.createDate=Date.now(),e.signInDate=Date.now(),e.currentDay=1,e.receivedDays=[],e.afterFillSignInDays=[],this.savePlayerInfoToLocalCache()},n.isNeedRecycleSignInInfo=function(){this.playerInfo.signInInfo||this.createNewSignInInfo();var e=!1;return vt.getDeltaDays(this.playerInfo.signInInfo.createDate,Date.now())>=ve.MAX_SIGNIN_DAY&&(e=!0),e},n.updateSignInReceivedDays=function(e){var t=this.playerInfo.signInInfo.receivedDays;Array.isArray(t)&&t.includes(e)||(t.push(Number(e)),this.savePlayerInfoToLocalCache())},n.updateSignInFillSignInDays=function(e,t){var n=this.playerInfo.signInInfo.afterFillSignInDays;if(t)n.length=0;else{if(Array.isArray(n)&&n.includes(e))return;n.push(Number(e))}this.savePlayerInfoToLocalCache()},n.getSignInReceivedInfo=function(){this.playerInfo.signInInfo||this.createNewSignInInfo();var e=this.playerInfo.signInInfo;return{isAllReceived:!(e.receivedDays.length<e.currentDay),isTodayReceived:!!e.receivedDays.includes(e.currentDay)}},n.isHadCarAndDuringPeriod=function(e){var t=this.playerInfo.signInInfo.createDate;this.playerInfo.dictGetCarTime||(this.playerInfo.dictGetCarTime={});var n=this.playerInfo.dictGetCarTime[e];return-1!==this.playerInfo.cars.indexOf(e)&&n&&n<t},n.updateDictGetCarTime=function(e){this.playerInfo.dictGetCarTime||(this.playerInfo.dictGetCarTime={}),this.playerInfo.dictGetCarTime[e]=this.playerInfo.signInInfo.createDate,$.instance.setConfigData(ve.LOCAL_CACHE.PLAYER,JSON.stringify(this.playerInfo))},n.getLastOnlineRewardTime=function(){return this.playerInfo.onlineRewardTime||(this.playerInfo.onlineRewardTime=this.getCurrentTime(),this.savePlayerInfoToLocalCache()),this.playerInfo.onlineRewardTime},n.updateLastOnlineRewardTime=function(e){var t=this.getCurrentTime()-1e3*e;this.playerInfo.onlineRewardTime=t,this.savePlayerInfoToLocalCache()},n.syncServerTime=function(e){this.serverTime=e,this.localTime=Date.now()},n.getCurrentTime=function(){var e=Date.now()-this.localTime;return this.serverTime+e},n.hasCar=function(e){return e===ve.INITIAL_CAR||(this.playerInfo.cars||(this.playerInfo.cars=[ve.INITIAL_CAR]),-1!==this.playerInfo.cars.indexOf(e))},n.hasCarCanReceived=function(){for(var e=Dt.instance.getCars(),t=0;t<e.length;t++){var n=e[t];if(n.type!==ve.BUY_CAR_TYPE.GOLD&&n.type!==ve.BUY_CAR_TYPE.SIGNIN&&(!this.hasCar(n.ID)&&this.playerInfo.dictBuyTask&&this.playerInfo.dictBuyTask.hasOwnProperty(n.type)&&this.playerInfo.dictBuyTask[n.type]>=n.num))return!0}return!1},n.finishBuyTask=function(e,t,n){this.playerInfo.dictBuyTask||(this.playerInfo.dictBuyTask={}),this.playerInfo.dictBuyTask.hasOwnProperty(e)&&n?this.playerInfo.dictBuyTask[e]+=t:this.playerInfo.dictBuyTask[e]=t,this.savePlayerInfoToLocalCache()},n.getBuyTypeProgress=function(e){return this.playerInfo.dictBuyTask&&this.playerInfo.dictBuyTask.hasOwnProperty(e)?this.playerInfo.dictBuyTask[e]:0},n.getCurrentCar=function(){return this.playerInfo.currentCar||(this.playerInfo.currentCar=ve.INITIAL_CAR),this.playerInfo.currentCar},n.useCar=function(e){return!!this.hasCar(e)&&(this.playerInfo.currentCar=e,this.savePlayerInfoToLocalCache(),this.showCar=this.playerInfo.currentCar,!0)},n.buyCar=function(e){return-1!==this.playerInfo.cars.indexOf(e)||(this.playerInfo.cars.push(e),this.savePlayerInfoToLocalCache()),!0},n.clear=function(){this.playerInfo={},this.settings={},this.saveAll()},n.passLevel=function(e){this.playerInfo.level++,this.playerInfo.gold+=e,console.log("###1 this.playerInfo.level",this.playerInfo.level,"this.playerInfo.realLevel",this.playerInfo.realLevel),this.playerInfo.passCheckPoint?(this.playerInfo.realLevel=this.getRandLevel(),console.log("###3 this.playerInfo.level",this.playerInfo.level,"this.playerInfo.realLevel",this.playerInfo.realLevel)):this.playerInfo.level>=ve.MAX_LEVEL?(this.playerInfo.realLevel=ve.MAX_LEVEL,this.playerInfo.level=ve.MAX_LEVEL,this.playerInfo.passCheckPoint=!0,console.log("###2 this.playerInfo.level",this.playerInfo.level,"this.playerInfo.realLevel",this.playerInfo.realLevel)):this.playerInfo.realLevel=this.playerInfo.level,this.savePlayerInfoToLocalCache()},n.getRandLevel=function(){for(var e=-1;-1===e;){var t=16+Math.floor(5*Math.random());t!==this.playerInfo.realLevel&&(e=t)}return e},V(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}(T),H(Pt,"_instance",void 0),St=_t))||St);e._RF.pop(),e._RF.push({},"0ab97H51jJALJr6aO9gzNGg","carManager",void 0);var Ft,zt,Ut=t.ccclass,xt=t.property,Yt=(Ot=Ut("carManager"),Nt=xt({type:st}),Ot((kt=K((Lt=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"followCamera",kt,q(t)),t}W(t,e);var n=t.prototype;return n.start=function(){},n.onEnable=function(){ue.on("showInvincible",this.showInvincible,this)},n.onDisable=function(){ue.off("showInvincible",this.showInvincible,this)},n.showInvincible=function(){this.mainCar&&(this.mainCar.isInvincible=!0)},n.init=function(e,t){this._fightMap=e,this._customerManager=t,this.creatMainCar()},n.creatMainCar=function(){var e=this,t=Gt.instance.showCar?Gt.instance.showCar:ve.INITIAL_CAR,n=Dt.instance.queryByID("car",t.toString()),i=n?n.model:ve.MIN_CAR_ID;he.getCar(i,(function(t,n){if(t)console.error(t);else{e.mainCar&&Pe.instance.putNode(e.mainCar.node);var i=Pe.instance.getNode(n,e.node);e.mainCar=i.getComponent("car"),e.mainCar.markMainCar(!0),e.mainCar.setEntry(e._fightMap.path[0]),e.mainCar.manager=e._customerManager,e.mainCar.maxProgress=e._fightMap.levelProgressCnt,e.mainCar.setMoveOverListener((function(){})),e.followCamera.followTarget=i,e.followCamera.showStart()}}))},n.preloadAICar=function(e){for(var t=[],n=1;n<this._fightMap.path.length;n++){var i=this._fightMap.path[n].getComponent(ft);if(i.type!==ie.ROAD_POINT_TYPE.AI_START)return;for(var r=i.cars.split(","),o=0;o<r.length;o++)-1===t.indexOf(r[o])&&t.push(r[o])}var a=0;he.getCarsBatch(t,(function(e){++a<=15&&ue.dispatchEvent("updateLoading",2)}),(function(){a<=15&&ue.dispatchEvent("updateLoading",30-2*a),e&&e()}))},n.startGenerateEnemy=function(){this.genAICar=this.genAICar.bind(this);for(var e=1;e<this._fightMap.path.length;e++){this._fightMap.path[e].getComponent(ft).startGenerateCar(this.genAICar)}},n.stopGenerateEnemy=function(){for(var e=1;e<this._fightMap.path.length;e++){this._fightMap.path[e].getComponent(ft).stopGenerateCar()}},n.genAICar=function(e,t){var n=this;he.getCar(t,(function(t,i){if(t)console.error(t);else{var r=Pe.instance.getNode(i,n.node).getComponent("car");r.setEntry(e.node),r.minSpeed=e.carSpeed,r.maxSpeed=e.carSpeed,r.startRunning(),r.markMainCar(!1),r.setMoveOverListener((function(e){Pe.instance.putNode(e.node)}))}}))},n.reset=function(){this.mainCar.setEntry(this._fightMap.path[0]),this.mainCar.maxProgress=this._fightMap.levelProgressCnt,this.followCamera.followTarget=this.mainCar.node,this.stopGenerateEnemy(),this.recycleAllAICar()},n.recycleAllAICar=function(){var e=[];this.node.children.forEach((function(t){e.push(t)}),this),e.forEach((function(e){var t=e.getComponent("car");t&&!t.isMain&&Pe.instance.putNode(e)}))},n.recycleLimitAICar=function(){var e=this,t=[];this.node.children.forEach((function(e){t.push(e)}),this),t.forEach((function(t){var n=t.getComponent("car"),i=b.distance(t.worldPosition,e.mainCar.node.worldPosition);n&&!n.isMain&&Math.abs(i)<=5?Pe.instance.putNode(t):(n.isOver=!1,n.startRunning())}))},n.controlMainCar=function(e){e?(ue.dispatchEvent("showGuide",!1),this.mainCar.startRunning()):this.mainCar.stopRunning()},n.startGame=function(){ue.dispatchEvent("showGuide",!0),this.mainCar.startWithMinSpeed(),this.startGenerateEnemy(),this.schedule(this.checkCarIsCloser,.2,S.REPEAT_FOREVER)},n.gameOver=function(){this.followCamera.followTarget=null,this.stopGenerateEnemy(),this.unschedule(this.checkCarIsCloser),this.node.children.forEach((function(e){e.getComponent(Ge).stopImmediately()}))},n.changeCameraFollowRotation=function(){this.followCamera.isFollowRotation=!this.followCamera.isFollowRotation},n.getCurrentProgress=function(){return{cur:this.mainCar.curProgress,isOver:!this.mainCar.hasCustomer}},n.revive=function(){this.recycleLimitAICar(),this.mainCar.revive(),this.followCamera.followTarget=this.mainCar.node,this.startGenerateEnemy()},n.checkCarIsCloser=function(){if(this.mainCar.isCarMoving){var e=this.mainCar.node,t=e.getWorldPosition();this.node.children.forEach((function(n){if(n!==e){var i=n.getWorldPosition(),r=n.forward;i.x-=r.x,i.z-=r.z,Math.abs(i.x-t.x)<2&&Math.abs(i.z-t.z)<2&&n.getComponent(Ge).tooting()}}))}},t}(T)).prototype,"followCamera",[Nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Mt=Lt))||Mt);e._RF.pop(),e._RF.push({},"10a09om3sZD8q2H50TLwLIc","eventListener",void 0);var Vt,Ht,Wt,jt,qt,Xt=t.ccclass,Kt=(t.property,Xt("oneToOneListener")(Ft=function(){function e(){H(this,"supportEvent",{}),H(this,"handle",{}),this.supportEvent=null}var t=e.prototype;return t.on=function(e,t,n){this.handle[e]={handler:t,target:n}},t.off=function(e,t){var n=this.handle[e];n&&n.handler&&n.handler===t&&delete this.handle[e]},t.dispatchEvent=function(e){if(null===this.supportEvent||this.supportEvent.hasOwnProperty(e)){for(var t=this.handle[e],n=[],o=1;o<arguments.length;o++)n.push(arguments[o]);t.handler?t.handler.apply(t.target,n):i("not register "+e+"    callback func")}else r("please add the event into clientEvent.js")},t.setSupportEventList=function(e){if(!(e instanceof Array))return r("supportEvent was not array"),!1;for(var t in this.supportEvent={},e){var n=e[t];this.supportEvent[n]=t}return!0},e}())||Ft);Xt("eventListener")(zt=function(){function e(){}return e.getBaseClass=function(e){return Kt},e}());e._RF.pop(),e._RF.push({},"60f49uw4/dA4rGh/C738U1T","tips",void 0);var Zt,Jt,Qt,$t=t.ccclass,en=t.property,tn=(Vt=$t("tips"),Ht=en(P),Vt((qt=K((jt=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"lbTips",qt,q(t)),H(q(t),"targetPos",void 0),t}W(t,e);var n=t.prototype;return n.start=function(){},n.show=function(e,t){var n=this;this.targetPos=new b(0,200,0),this.node.setPosition(this.targetPos),this.lbTips.string=e;var i=this.lbTips.node.getComponent(_).contentSize;u(i)?(this.node.getComponent(_).setContentSize(i.width+100<240?240:i.width+100,i.height+30),this.scheduleOnce((function(){A(n.targetPos).by(.8,new b(0,150,0)).call((function(){t&&t(),Pe.instance.putNode(n.node)})).start()}),.8)):Pe.instance.putNode(this.node)},t}(T)).prototype,"lbTips",[Ht],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Wt=jt))||Wt);e._RF.pop(),e._RF.push({},"ae98dhzQlZL2p1SbDgvNdoJ","uiManager",void 0);var nn,rn,on,an,sn,ln,cn,un,hn,pn,fn,dn=t.ccclass,gn=(t.property,dn("uiManager")((Qt=Jt=function(){function e(){H(this,"dictSharedPanel",{}),H(this,"dictLoading",{}),H(this,"arrPopupDialog",[]),H(this,"showTipsTime",0)}var t=e.prototype;return t.showDialog=function(e,t,n){var i=this;if(!this.dictLoading[e]){var r=e.lastIndexOf("/"),o=e.slice(r+1);if(t||(t=[]),this.dictSharedPanel.hasOwnProperty(e)){var a=this.dictSharedPanel[e];if(u(a)){a.parent=l("Canvas"),a.active=!0;var s=a.getComponent(o);return s.show&&s.show.apply(s,t),void(n&&n(s))}}this.dictLoading[e]=!0,he.createUI(e,(function(r,a){var s=!1;if(i.dictLoading[e]||(s=!0),i.dictLoading[e]=!1,r)console.error(r);else{i.dictSharedPanel[e]=a;var l=a.getComponent(o);l.show&&l.show.apply(l,t),n&&n(l),s&&i.hideDialog(e)}}))}},t.hideDialog=function(e,t){if(this.dictSharedPanel.hasOwnProperty(e)){var n=this.dictSharedPanel[e];n&&u(n)?(n.parent=null,t&&"function"==typeof t&&t()):t&&"function"==typeof t&&t()}this.dictLoading[e]=!1},t.pushToPopupSeq=function(e,t,n){var i={panelPath:e,scriptName:t,param:n,isShow:!1};this.arrPopupDialog.push(i),this.checkPopupSeq()},t.insertToPopupSeq=function(e,t,n){var i={panelPath:t,param:n,isShow:!1};this.arrPopupDialog.splice(e,0,i)},t.shiftFromPopupSeq=function(e){var t=this;this.hideDialog(e,(function(){t.arrPopupDialog[0]&&t.arrPopupDialog[0].panelPath===e&&(t.arrPopupDialog.shift(),t.checkPopupSeq())}))},t.checkPopupSeq=function(){if(this.arrPopupDialog.length>0){var e=this.arrPopupDialog[0];e.isShow||(this.showDialog(e.panelPath,e.param),this.arrPopupDialog[0].isShow=!0)}},t.showTips=function(e,t){var n=Date.now();if(n-this.showTipsTime<800){var i=800-(n-this.showTipsTime),r=this;setTimeout(function(e,t){r._showTipsAni(e,t)}.bind(this,e,t),i),this.showTipsTime=n+i}else this._showTipsAni(e,t),this.showTipsTime=n},t._showTipsAni=function(e,t){he.getUIPrefabRes("common/tips",(function(n,i){n||Pe.instance.getNode(i,l("Canvas")).getComponent(tn).show(e,t)}))},V(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}(),H(Jt,"_instance",void 0),Zt=Qt))||Zt);e._RF.pop(),e._RF.push({},"2b1f3615PZNnqYSDTVo5tI8","shopItem",void 0);var vn,yn,mn,bn,In,Cn=t.ccclass,wn=t.property,Rn=(nn=Cn("shopItem"),rn=wn(m),on=wn(m),an=wn(m),sn=wn(D),nn((un=K((cn=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"nodeSelect",un,q(t)),X(q(t),"nodeUsed",hn,q(t)),X(q(t),"nodeRedDot",pn,q(t)),X(q(t),"spCarIcon",fn,q(t)),H(q(t),"currentCar",null),H(q(t),"carInfo",{ID:0,type:0,num:0,model:""}),t}W(t,e);var n=t.prototype;return n.start=function(){},n.onEnable=function(){ue.on("buyCar",this.refreshCarIcon,this),ue.on("updateBuyTask",this.updateBuyTask,this)},n.onDisable=function(){ue.off("buyCar",this.refreshCarIcon,this),ue.off("updateBuyTask",this.updateBuyTask,this)},n.refreshCarIcon=function(){this.carInfo&&(he.setCarIcon(this.carInfo.model,this.spCarIcon,!Gt.instance.hasCar(this.carInfo.ID),(function(){})),this.updateBuyTask())},n.updateBuyTask=function(){if(Gt.instance.hasCar(this.carInfo.ID))this.nodeRedDot.active=!1;else{var e=Gt.instance.getBuyTypeProgress(this.carInfo.type);this.nodeRedDot.active=e>=this.carInfo.num}},n.show=function(e){var t=this;this.carInfo=e,this.select=!1,this.nodeUsed.active=!1,this.currentCar&&(Pe.instance.putNode(this.currentCar),this.currentCar=null),e?(this.spCarIcon.node.active=!0,this.refreshCarIcon(),this.carInfo.ID===Gt.instance.getCurrentCar()&&this.scheduleOnce((function(){t.onItemClick(!1)}),0)):this.spCarIcon.node.active=!1},n.onItemClick=function(e){if(this.carInfo){var t=Gt.instance.hasCar(this.carInfo.ID);ue.dispatchEvent("onShopItemSelect",this.carInfo.ID,t),this.select=!0,t&&(this.used=!0,Gt.instance.useCar(this.carInfo.ID),ue.dispatchEvent("updateCar"))}},n.updateUseState=function(){this.used=this.carInfo.ID===Gt.instance.getCurrentCar()},V(t,[{key:"select",get:function(){return this.nodeSelect.active},set:function(e){this.nodeSelect.active=e}},{key:"used",get:function(){return this.nodeUsed.active},set:function(e){this.nodeUsed.active=e}}]),t}(T)).prototype,"nodeSelect",[rn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),hn=K(cn.prototype,"nodeUsed",[on],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pn=K(cn.prototype,"nodeRedDot",[an],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fn=K(cn.prototype,"spCarIcon",[sn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ln=cn))||ln);e._RF.pop(),e._RF.push({},"35980PVGZdO6o5scEE8kciy","shopPage",void 0);var Tn,En=t.ccclass,Sn=t.property,Pn=(vn=En("shopPage"),yn=Sn(a),vn((In=K((bn=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"pfShopItem",In,q(t)),H(q(t),"page",0),t}W(t,e);var n=t.prototype;return n.start=function(){},n.setPage=function(e){this.page=e},n.show=function(){for(var e=Dt.instance.getCars(),t=9*this.page,n=9*(this.page+1),i=0,r=t;r<n;r++,i++){var o=null;i<this.node.children.length?o=this.node.children[i]:(o=s(this.pfShopItem)).parent=this.node,o.getComponent(Rn).show(e[r])}},n.unSelectAll=function(){this.node.children.forEach((function(e){e.getComponent(Rn).select=!1}))},n.unUseAll=function(){this.node.children.forEach((function(e){e.getComponent(Rn).used=!1}))},n.refreshUse=function(e){this.node.children.forEach((function(t){var n=t.getComponent(Rn);n.carInfo.ID===e&&n.onItemClick()}))},t}(T)).prototype,"pfShopItem",[yn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mn=bn))||mn);e._RF.pop(),e._RF.push({},"62dd66o/TBEyqhX8gZkE8/G","flyRewardItem",void 0);var _n,An,Dn,On,Nn,Mn,Ln,kn,Bn,Gn=t.ccclass,Fn=(t.property,Gn("flyRewardItem")(Tn=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return H(q(t=e.call.apply(e,[this].concat(i))||this),"targetPos",new b),H(q(t),"targetRotation",new b(0,0,0)),H(q(t),"targetScale",new b(1,1,1)),H(q(t),"posLast",new b),H(q(t),"_callback",null),t}W(t,e);var n=t.prototype;return n.start=function(){},n.show=function(e,t,n){var i=this;this.posLast.set(t),this._callback=n;var r=this.node.addComponent(D);r.trim=!1,r.sizeMode=D.SizeMode.RAW,r.spriteFrame=e,this.node.eulerAngles=new b(0,0,Math.floor(360*Math.random())),this.targetRotation=new b(this.node.eulerAngles);var o=new b(Math.floor(300*Math.random())-150,Math.floor(300*Math.random())-150,0),a=b.distance(o,new b(0,0,0))/400;A(this.targetPos).to(a,o,{easing:"cubicInOut"}).start();var s=120+Math.floor(60*Math.random());s=this.targetRotation.z+Math.floor(2*Math.random())===1?s:-s,A(this.targetRotation).to(a,new b(0,0,s)).start(),A(this.targetScale).to(2*a/3,new b(1.4,1.4,1.4)).to(a/3,new b(1,1,1)).call((function(){i.move2Target()})).start()},n.move2Target=function(){var e=this,t=b.distance(this.node.position,this.posLast)/1500,n=Math.floor(10*Math.random())/10;A(this.targetScale).to(.3,new b(1.4,1.4,1.4)).to(.7,new b(1,1,1)).union().repeat(50).start(),this.scheduleOnce((function(){A(e.targetPos).to(t,e.posLast).call((function(){e._callback&&e._callback(e.node)})).start()}),n)},n.update=function(e){this.node.position=this.targetPos,this.node.eulerAngles=this.targetRotation,this.node.setScale(this.targetScale)},t}(T))||Tn);e._RF.pop(),e._RF.push({},"d14d4EewSBFtIn6B/rRUvjM","flyReward",void 0);var zn,Un,xn,Yn=t.ccclass,Vn=t.property,Hn=(_n=Yn("flyReward"),An=Vn(c),Dn=Vn(m),On=Vn(O),_n((Ln=K((Mn=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"imgGold",Ln,q(t)),X(q(t),"ndRewardParent",kn,q(t)),X(q(t),"aniBoom",Bn,q(t)),H(q(t),"finishIdx",0),H(q(t),"_callback",void 0),H(q(t),"isGoldOrDiamond",!0),t}W(t,e);var n=t.prototype;return n.start=function(){this.aniBoom.play(),this.createReward()},n.getTargetPos=function(){var e=l("Canvas/goldPos");return e?e.position:(this.node.destroy(),this._callback&&this._callback(),b.ZERO)},n.createReward=function(){for(var e=this,t=this.imgGold,n=this.getTargetPos(),i=0;i<10;i++){var r=new m("flyRewardItem"),o=r.addComponent(Fn);r.parent=this.ndRewardParent,o.show(t,n,(function(t){e.onFlyOver(t)}))}},n.setInfo=function(e){this.isGoldOrDiamond=e},n.onFlyOver=function(e){this.isGoldOrDiamond?ue.dispatchEvent("receiveGold"):ue.dispatchEvent("receiveDiamond"),e.active=!1,this.finishIdx++,10===this.finishIdx&&(this._callback&&this._callback(),this.node.destroy())},n.setEndListener=function(e){this._callback=e},t}(T)).prototype,"imgGold",[An],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),kn=K(Mn.prototype,"ndRewardParent",[Dn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Bn=K(Mn.prototype,"aniBoom",[On],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Nn=Mn))||Nn);e._RF.pop(),e._RF.push({},"b6eeddtwEdPDYszSPn2rVjb","gameLogic",void 0);var Wn=(0,t.ccclass)("gameLogic")((xn=Un=function(){function e(){}return e.addGold=function(e){Gt.instance.updatePlayerInfo("gold",e),ue.dispatchEvent("updateGold")},e.useCar=function(e){Gt.instance.useCar(e),ue.dispatchEvent("updateCar")},e.buyCar=function(e){Gt.instance.buyCar(e),ue.dispatchEvent("buyCar")},e.isVibrateOpen=function(){var e=$.instance.getGlobalData("vibrate");return null==e&&(e=!0),e},e.getOpenRewardType=function(e,t,n){t(null,ve.OPEN_REWARD_TYPE.NULL)},e.checkIsByVideoAds=function(){return!1},e.updateRewardIcon=function(e,t,n,i,r){var o=this;this.getOpenRewardType(e,(function(e,a){switch(a){case ve.OPEN_REWARD_TYPE.AD:t.node.active=!0,t.spriteFrame=i||o.imgAd;break;case ve.OPEN_REWARD_TYPE.SHARE:t.node.active=!0,t.spriteFrame=r||o.imgShare;break;case ve.OPEN_REWARD_TYPE.NULL:t.node.active=!1}n&&n(e,a)}))},e.finishBuyTask=function(e,t,n){Gt.instance.finishBuyTask(e,t,n),ue.dispatchEvent("updateBuyTask")},e.openReward=function(e,t){t&&t(null)},e.afterLogin=function(){Gt.instance.isNewBee||this.checkSignIn()},e.checkSignIn=function(){1!==Gt.instance.playerInfo.level&&(Gt.instance.updateSignInCurrentDay(),Gt.instance.getSignInReceivedInfo().isTodayReceived||gn.instance.pushToPopupSeq("signIn/signIn","signIn",{}))},e.showFlyReward=function(e,t){he.createUI("common/flyReward",(function(e,n){e?t&&t():n.getComponent(Hn).setEndListener(t)}))},e}(),H(Un,"imgAd",null),H(Un,"imgShare",null),zn=xn))||zn;e._RF.pop(),e._RF.push({},"26839JcVWpGabE9xA7/uWJw","polyglot.min",void 0);var jn=function(e,t,n){if(e=arguments[0],t="function"==typeof arguments[1]?arguments[1]:new Function,Array.isArray(e))e.forEach((function(e,n,i){t(e,n)}));else for(var i in e)if(e.hasOwnProperty(i)){var r=e[i];t(r,i)}},qn=function(e,t){return e.hasOwnProperty(t)};var Xn=function(e){!function(e){console.warn(e)}(e)},Kn=String.prototype.replace,Zn=String.prototype.split,Jn="||||",Qn=function(e){var t=e%100,n=t%10;return 11!==t&&1===n?0:2<=n&&n<=4&&!(t>=12&&t<=14)?1:2},$n={pluralTypes:{arabic:function(e){if(e<3)return e;var t=e%100;return t>=3&&t<=10?3:t>=11?4:5},bosnian_serbian:Qn,chinese:function(){return 0},croatian:Qn,french:function(e){return e>1?1:0},german:function(e){return 1!==e?1:0},russian:Qn,lithuanian:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=9&&(e%100<11||e%100>19)?1:2},czech:function(e){return 1===e?0:e>=2&&e<=4?1:2},polish:function(e){if(1===e)return 0;var t=e%10;return 2<=t&&t<=4&&(e%100<10||e%100>=20)?1:2},icelandic:function(e){return e%10!=1||e%100==11?1:0},slovenian:function(e){var t=e%100;return 1===t?0:2===t?1:3===t||4===t?2:3}},pluralTypeToLanguages:{arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is"],slovenian:["sl-SL"]}};function ei(e,t){var n=function(e){var t={};return jn(e,(function(e,n){jn(e,(function(e){t[e]=n}),this)}),this),t}(e.pluralTypeToLanguages);return n[t]||n[Zn.call(t,/-/,1)[0]]||n.en}function ti(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var ni=/%\{(.*?)\}/g;function ii(e,t,n,i,r){if("string"!=typeof e)throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(null==t)return e;var o=e,a=i||ni,s=r||$n,l="number"==typeof t?{smart_count:t}:t;if(null!=l.smart_count&&o){var c=Zn.call(o,Jn);o=(c[function(e,t,n){return e.pluralTypes[ei(e,t)](n)}(s,n||"en",l.smart_count)]||c[0]).replace(/^\s+|\s+$/gm,"")}return o=Kn.call(o,a,(function(e,t){return qn(l,t)&&null!=l[t]?l[t]:e}))}var ri,oi=function(){function e(e){H(this,"phrases",{}),H(this,"pluralRules",{}),H(this,"currentLocale",""),H(this,"onMissingKey",null),H(this,"warn",null),H(this,"tokenRegex",void 0);var t=e||{};this.extend(t.phrases||{}),this.currentLocale=t.locale||"en";var n=t.allowMissing?ii:null;this.onMissingKey="function"==typeof t.onMissingKey?t.onMissingKey:n,this.warn=t.warn||Xn,this.tokenRegex=function(e){var t=e&&e.prefix||"%{",n=e&&e.suffix||"}";if(t===Jn||n===Jn)throw new RangeError('"||||" token is reserved for pluralization');return new RegExp(ti(t)+"(.*?)"+ti(n),"g")}(t.interpolation),this.pluralRules=t.pluralRules||$n}e.transformPhrase=function(e,t,n){return ii(e,t,n)};var t=e.prototype;return t.has=function(e){return qn(this.phrases,e)},t.t=function(e,t){var n,i,r=null==t?{}:t;if("string"==typeof this.phrases[e])n=this.phrases[e];else if("string"==typeof r._)n=r._;else if(this.onMissingKey){i=(0,this.onMissingKey)(e,r,this.currentLocale,this.tokenRegex,this.pluralRules)}else this.warn('Missing translation for key: "'+e+'"'),i=e;return"string"==typeof n&&(i=ii(n,r,this.currentLocale,this.tokenRegex,this.pluralRules)),i},t.replace=function(e){this.clear(),this.extend(e)},t.clear=function(){this.phrases={}},t.locale=function(e){return e&&(this.currentLocale=e),this.currentLocale},t.extend=function(e,t){var n=this;jn(e,(function(e,i){var r=t?t+"."+i:i;"object"==typeof e?n.extend(e,r):n.phrases[r]=e}),this)},t.unset=function(e,t){"string"==typeof e?delete this.phrases[e]:jn(e,(function(e,n){var i=t?t+"."+n:n;"object"==typeof e?this.unset(e,i):delete this.phrases[i]}),this)},e}();function ai(e){return window.i18nConfig.languages[e]}function si(e){e&&(ri?ri.replace(e):ri=new oi({phrases:e,allowMissing:!0}))}e._RF.pop(),e._RF.push({},"d6597NeRz5OuZ6kceJkHWc3","LanguageData",void 0),window.i18nConfig||(window.i18nConfig={languages:{},curLang:""});var li,ci,ui,hi,pi,fi,di,gi,vi,yi,mi,bi,Ii,Ci,wi,Ri,Ti,Ei,Si,Pi,_i,Ai,Di,Oi,Ni,Mi,Li,ki,Bi,Gi=function(){function e(){}return e.init=function(e){if(e&&e!==window.i18nConfig.curLang){var t=ai(e)||{};window.i18nConfig.curLang=e,si(t),this.inst=ri}},e.t=function(e,t){0===Object.keys(ri.phrases).length&&(si(ai(window.i18nConfig.curLang)||{}),console.warn("###防止出现parses数据丢失，重新替换数据"));if(ri)return ri.t(e,t)},e.prototype.updateSceneRenderers=function(){for(var e=N.getScene().children,t=[],n=0;n<e.length;++n){var i=e[n].getComponentsInChildren("LocalizedLabel");Array.prototype.push.apply(t,i)}for(var r=0;r<t.length;++r){var o=t[r];o.node.active&&o.updateLabel()}for(var a=[],s=0;s<e.length;++s){var l=e[s].getComponentsInChildren("LocalizedSprite");Array.prototype.push.apply(a,l)}for(var c=0;c<a.length;++c){var u=a[c];u.node.active&&u.updateSprite(window.i18nConfig.curLang)}},e}();H(Gi,"inst",null),e._RF.pop(),e._RF.push({},"15effXNtKpGeLctODlTRqhl","shop",void 0);var Fi,zi,Ui,xi,Yi,Vi=t.ccclass,Hi=t.property;li=Vi("shop"),ci=Hi(P),ui=Hi(m),hi=Hi(m),pi=Hi(m),fi=Hi(m),di=Hi(P),gi=Hi(P),vi=Hi(P),yi=Hi(m),mi=Hi(m),bi=Hi(a),Ii=Hi(D),Ci=Hi(P),li((Ti=K((Ri=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"lbGold",Ti,q(t)),X(q(t),"nodeGet",Ei,q(t)),X(q(t),"nodeGold",Si,q(t)),X(q(t),"nodeBuy",Pi,q(t)),X(q(t),"nodeGo",_i,q(t)),X(q(t),"lbDesc",Ai,q(t)),X(q(t),"lbPrice",Di,q(t)),X(q(t),"lbGo",Oi,q(t)),X(q(t),"nodeCarParent",Ni,q(t)),X(q(t),"nodePages",Mi,q(t)),X(q(t),"pfPage",Li,q(t)),X(q(t),"spCarBlack",ki,q(t)),X(q(t),"lbPage",Bi,q(t)),H(q(t),"currentPage",null),H(q(t),"currentCar",null),H(q(t),"carDegree",0),H(q(t),"rotateSpeed",30),H(q(t),"currentCarInfo",void 0),H(q(t),"pageIndex",0),H(q(t),"maxPage",0),H(q(t),"currentCarID",0),t}W(t,e);var n=t.prototype;return n.start=function(){},n.onEnable=function(){ue.on("updateGold",this.updateGold,this),ue.on("onShopItemSelect",this.onShopItemSelect,this),ue.on("updateBuyTask",this.updateButtons,this)},n.onDisable=function(){ue.off("updateGold",this.updateGold,this),ue.off("onShopItemSelect",this.onShopItemSelect,this),ue.off("updateBuyTask",this.updateButtons,this)},n.show=function(){var e=Dt.instance.getCars();this.maxPage=Math.floor(e.length/9),this.updateGold(),this.showPage()},n.showPage=function(){this.currentPage||(this.currentPage=s(this.pfPage),this.currentPage.parent=this.nodePages,this.pageIndex=0,this.refreshPageLabel(),this.currentPage.getComponent(Pn).setPage(this.pageIndex)),this.currentPage.getComponent(Pn).show()},n.updateGold=function(){var e=Gt.instance.playerInfo.gold||0;this.lbGold.string=vt.formatMoney(e)},n.onBtnCloseClick=function(){gn.instance.hideDialog("shop/shop")},n.getCar=function(){var e=this;Wn.buyCar(this.currentCarInfo.ID);var t={rewardType:ve.REWARD_TYPE.CAR,amount:1,ID:this.currentCarInfo.ID};gn.instance.showDialog("common/showReward",[t,!1,"购买成功",function(){Wn.useCar(e.currentCarInfo.ID),e.currentPage.getComponent(Pn).refreshUse(e.currentCarInfo.ID)},null,"确认"])},n.onBtnGetClick=function(){var e=this.currentCarInfo.ID;if(!Gt.instance.hasCar(e))if(this.currentCarInfo.type===ve.BUY_CAR_TYPE.GOLD){if(this.currentCarInfo.num>Gt.instance.playerInfo.gold)return void gn.instance.showTips("获取金币",(function(){}));Wn.addGold(-this.currentCarInfo.num),this.getCar()}else{if(Gt.instance.getBuyTypeProgress(this.currentCarInfo.type)>=this.currentCarInfo.num)this.getCar();else switch(this.currentCarInfo.type){case ve.BUY_CAR_TYPE.GAME:case ve.BUY_CAR_TYPE.LOGIN:case ve.BUY_CAR_TYPE.CONTINUOUS_LOGIN:case ve.BUY_CAR_TYPE.PASS_LEVEL:this.onBtnCloseClick();break;case ve.BUY_CAR_TYPE.SIGNIN:this.onBtnCloseClick(),gn.instance.showDialog("signIn/signIn");break;case ve.BUY_CAR_TYPE.SHARE:Wn.openReward(ve.SHARE_FUNCTION.SHOP_SHARE,(function(e,t){}));break;case ve.BUY_CAR_TYPE.VIDEO:Wn.openReward(ve.SHARE_FUNCTION.SHOP_VIDEO,(function(e,t){}))}}},n.checkBtn=function(){},n.onBtnGoldClick=function(){var e=this;Wn.openReward(ve.SHARE_FUNCTION.SHOP_VIDEO,(function(t){t||Wn.showFlyReward(ve.REWARD_TYPE.GOLD,(function(){Wn.addGold(300),e.updateButtons()}))}))},n.onShopItemSelect=function(e,t){var n=this,i=this.currentPage.getComponent(Pn);i.unSelectAll(),t&&i.unUseAll(),this.currentCar&&(Pe.instance.putNode(this.currentCar),this.currentCar=null),this.currentCarInfo=Dt.instance.queryByID("car",e.toString()),this.currentCarInfo.type===ve.BUY_CAR_TYPE.SHARE&&(this.currentCarInfo.type=ve.BUY_CAR_TYPE.GOLD,this.currentCarInfo.num=2e3),Gt.instance.hasCar(e)?(this.spCarBlack.node.active=!1,he.getUICar(this.currentCarInfo.model,(function(e,t){e?console.error(e,n.currentCarInfo.model):(n.carDegree=0,n.currentCar=Pe.instance.getNode(t,n.nodeCarParent))}))):(this.spCarBlack.node.active=!0,he.setCarIcon(this.currentCarInfo.model,this.spCarBlack,!0,(function(){}))),this.updateButtons()},n.update=function(e){this.currentCar&&(this.carDegree-=e*this.rotateSpeed,this.carDegree<=-360&&(this.carDegree+=360),this.currentCar.eulerAngles=new b(0,this.carDegree,0))},n.updateButtons=function(){if(Gt.instance.hasCar(this.currentCarInfo.ID))this.lbDesc.string="",this.nodeGo.active=!0,this.nodeBuy.active=!1,this.lbGo.string="获取",this.nodeGet.getComponent(M).interactable=!0;else if(this.currentCarInfo.type===ve.BUY_CAR_TYPE.GOLD)this.lbDesc.string="",this.lbPrice.string=this.currentCarInfo.num,Gt.instance.playerInfo.gold>=this.currentCarInfo.num?(this.lbPrice.color=L.WHITE,this.nodeGet.getComponent(M).interactable=!0):(this.lbPrice.color=L.RED,this.nodeGet.getComponent(M).interactable=!0),this.nodeGo.active=!1,this.nodeBuy.active=!0;else{this.nodeGet.getComponent(M).interactable=!0,this.nodeGo.active=!0,this.nodeBuy.active=!1;var e=Gt.instance.getBuyTypeProgress(this.currentCarInfo.type);e<this.currentCarInfo.num?this.lbGo.string="前往商店":this.lbGo.string="获取";var t=Gi.t("carTask."+this.currentCarInfo.show);this.currentCarInfo.type!==ve.BUY_CAR_TYPE.SIGNIN&&(t+="("+Gi.t("shop.current")+"："+e+"/"+this.currentCarInfo.num+")"),this.lbDesc.string=t}},n.refreshPageLabel=function(){this.lbPage.string=this.pageIndex+1+"/"+(this.maxPage+1)},n.onBtnLeftClick=function(){var e=this.currentPage.getComponent(Pn);this.pageIndex>0?this.pageIndex--:this.pageIndex=this.maxPage,this.refreshPageLabel(),e.setPage(this.pageIndex),e.show()},n.onBtnRightClick=function(){var e=this.currentPage.getComponent(Pn);this.pageIndex>=this.maxPage?this.pageIndex=0:this.pageIndex++,this.refreshPageLabel(),e.setPage(this.pageIndex),e.show()},t}(T)).prototype,"lbGold",[ci],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ei=K(Ri.prototype,"nodeGet",[ui],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Si=K(Ri.prototype,"nodeGold",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pi=K(Ri.prototype,"nodeBuy",[pi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_i=K(Ri.prototype,"nodeGo",[fi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ai=K(Ri.prototype,"lbDesc",[di],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Di=K(Ri.prototype,"lbPrice",[gi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Oi=K(Ri.prototype,"lbGo",[vi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ni=K(Ri.prototype,"nodeCarParent",[yi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Mi=K(Ri.prototype,"nodePages",[mi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Li=K(Ri.prototype,"pfPage",[bi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ki=K(Ri.prototype,"spCarBlack",[Ii],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Bi=K(Ri.prototype,"lbPage",[Ci],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),wi=Ri));e._RF.pop(),e._RF.push({},"273adkVLRhECoDje+nCdBuE","fightMap",void 0);var Wi,ji,qi,Xi,Ki,Zi,Ji=t.ccclass,Qi=t.property,$i=(Fi=Ji("fightMap"),zi=Qi({type:m,displayName:"各路线起点"}),Fi((Yi=K((xi=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"path",Yi,q(t)),H(q(t),"_progressListener",void 0),H(q(t),"_completeListener",void 0),H(q(t),"curProgress",0),H(q(t),"maxProgress",0),H(q(t),"levelProgressCnt",0),t}W(t,e);var n=t.prototype;return n.buildMap=function(e,t,n){this._progressListener=t,this._completeListener=n,this.objMap=e,this.curProgress=0,this.maxProgress=6,this.buildModel("plane"),this.buildModel("road"),this.buildModel("tree"),this.buildModel("house"),this.buildModel("sign"),this.buildPath()},n.buildModel=function(e){var t=this;if(this.objMap.hasOwnProperty(e)){for(var n=[],i=this.objMap[e],r=0;r<i.children.length;r++){var o=i.children[r].name;-1===n.indexOf(o)&&n.push(o)}var a={};he.getMapObjs(e,n,(function(){}),(function(n,r){if(n)console.error(n);else{for(var o=0;o<r.length;o++){var s=r[o];a[s.data.name]=s}var l=new m(e);l.parent=t.node,l.setPosition(new b(i.pX,i.pY,i.pZ));for(var c=0;c<i.children.length;c++){var u=i.children[c],h=a[u.name],p=Pe.instance.getNode(h,l);p.setPosition(u.pX,u.pY,u.pZ),p.eulerAngles=new b(u.rX,u.rY,u.rZ),p.setScale(u.sX,u.sY,u.sZ)}t.triggerFinished(e)}}))}else this.triggerFinished(e)},n.buildPath=function(){if(this.objMap.hasOwnProperty("path")){this.path=[],this.levelProgressCnt=0;var e=this.objMap.path,t=new m("path");t.parent=this.node,t.setPosition(e.pX,e.pY,e.pZ);for(var n=0;n<e.children.length;n++){var i=e.children[n],r=new m(i.name);r.parent=t,r.setPosition(i.pX,i.pY,i.pZ);var o=this.createRoadPoint(i.path,r);o&&this.path.push(o)}this.triggerFinished("path")}},n.createRoadPoint=function(e,t){if(!e)return null;var n=new m(e.name);n.parent=t,n.setPosition(e.pX,e.pY,e.pZ),n.setScale(e.sX,e.sY,e.sZ),n.eulerAngles=new b(e.rX,e.rY,e.rZ);var i=n.addComponent(ft);return i.type=e.type,i.moveType=e.moveType,i.clockwise=e.clockwise,i.direction=e.direction,i.delayTime=e.delayTime,i.genInterval=e.genInterval,i.carSpeed=e.carSpeed,i.cars=e.cars,i.type===ie.ROAD_POINT_TYPE.PLATFORM&&this.levelProgressCnt++,e.next&&(i.next=this.createRoadPoint(e.next,t)),n},n.triggerFinished=function(e){console.log("build "+e+" finished!");var t="";switch(e){case"plane":t=Gi.t("fightMap.trimTheGround");break;case"road":t=Gi.t("fightMap.pavingTheRoad");break;case"tree":t=Gi.t("fightMap.plantingTree");break;case"house":t=Gi.t("fightMap.decorateHouse");break;case"sign":t=Gi.t("fightMap.paintLandmarks")}t&&ue.dispatchEvent("updateLoading",10,t),this.curProgress++,this._progressListener&&this._progressListener(this.curProgress,this.maxProgress),this.curProgress>=this.maxProgress&&this._completeListener&&this._completeListener()},n.recycle=function(){console.log("recycle map elements..."),this.recycleModel("plane"),this.recycleModel("road"),this.recycleModel("tree"),this.recycleModel("house"),this.recycleModel("sign"),this.node.removeAllChildren()},n.recycleModel=function(e){var t=this.node.getChildByName(e);if(t)for(var n=0;n<t.children.length;n++){var i=t.children[n];Pe.instance.putNode(i)}},t}(T)).prototype,"path",[zi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ui=xi))||Ui);e._RF.pop(),e._RF.push({},"93cd23dxExEBLbD/xbMp1PN","SpriteFrameSet",void 0);var er,tr,nr,ir,rr,or,ar,sr=t.ccclass,lr=t.property,cr=(Wi=sr("SpriteFrameSet"),ji=lr({type:c}),Wi((Ki=K((Xi=function(){H(this,"name","SpriteFrameSet"),X(this,"language",Ki,this),X(this,"spriteFrame",Zi,this)}).prototype,"language",[lr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Zi=K(Xi.prototype,"spriteFrame",[ji],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),qi=Xi))||qi);e._RF.pop(),e._RF.push({},"28bd9xEMv1GKLbTuAi4B4dI","LocalizedSprite",void 0);var ur,hr,pr,fr,dr,gr,vr,yr,mr,br=t.ccclass,Ir=t.property;er=br("LocalizedSprite"),tr=Ir({type:[cr],displayOrder:1}),er((ar=or=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return H(q(t=e.call.apply(e,[this].concat(i))||this),"sprite",null),X(q(t),"spriteFrameSet",rr,q(t)),t}W(t,e);var n=t.prototype;return n.onLoad=function(){this.fetchRender()},n.fetchRender=function(){var e=this.getComponent(D);if(e)return this.sprite=e,void this.updateSprite(window.i18nConfig.curLang)},n.getSpriteFrameByLang=function(e){for(var t=0;t<this.spriteFrameSet.length;++t)if(this.spriteFrameSet[t].language===e)return this.spriteFrameSet[t].spriteFrame},n.updateSprite=function(e){if(this.sprite){var t=this.getSpriteFrameByLang(e);!t&&this.spriteFrameSet[0]&&(t=this.spriteFrameSet[0].spriteFrame),t&&(this.sprite.spriteFrame=t)}else r("Failed to update localized sprite, sprite component is invalid!")},t}(T),H(or,"editor",{executeInEditMode:!0,inspector:"packages://i18n/inspector/localized-sprite.js",menu:"i18n/LocalizedSprite"}),rr=K((ir=ar).prototype,"spriteFrameSet",[tr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),nr=ir));e._RF.pop(),e._RF.push({},"349acC5lWBNyZL7loxYm/uD","online",void 0);var Cr,wr=t.ccclass,Rr=t.property;ur=wr("online"),hr=Rr(D),pr=Rr(D),fr=Rr(P),ur((vr=K((gr=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"spTimeProgress",vr,q(t)),X(q(t),"perTimeProgress",yr,q(t)),X(q(t),"lbGold",mr,q(t)),H(q(t),"currentTime",0),H(q(t),"isOverflow",!1),H(q(t),"currentGold",0),t}W(t,e);var n=t.prototype;return n.start=function(){},n.onEnable=function(){this.refresh()},n.refresh=function(){this.currentTime=0,this.perTimeProgress.fillRange=0;var e=Gt.instance.getLastOnlineRewardTime(),t=Math.floor((Gt.instance.getCurrentTime()-e)/1e3);t=(t=t>0?t:0)<ve.ONLINE.MAX_TIME?t:ve.ONLINE.MAX_TIME,this.isOverflow=t===ve.ONLINE.MAX_TIME,this.currentGold=Math.floor(t*ve.ONLINE.PROFIT_PER_SECOND),this.lbGold.string=vt.formatMoney(this.currentGold);var n=t/ve.ONLINE.MAX_TIME;n=n>1?1:n,this.spTimeProgress.fillRange=n},n.clear=function(){this.currentGold=0,this.lbGold.string="0",this.spTimeProgress.fillRange=0,Gt.instance.updateLastOnlineRewardTime(this.currentTime),this.isOverflow=!1},n.onBtnOnlineClick=function(){var e=this;this.currentGold<=0||(this.spTimeProgress.fillRange>=.5?gn.instance.showDialog("main/onlineDouble",[this.currentGold,function(){e.clear()}]):(Gt.instance.updatePlayerInfo("gold",this.currentGold),Wn.showFlyReward(ve.REWARD_TYPE.GOLD,(function(){ue.dispatchEvent("updateGold")})),this.clear()))},n.update=function(e){if(!this.isOverflow)if(this.currentTime+=e,this.currentTime>ve.ONLINE.TIME_PER_CIRCLE)this.refresh();else{var t=this.currentTime/ve.ONLINE.TIME_PER_CIRCLE;this.perTimeProgress.fillRange=t}},t}(T)).prototype,"spTimeProgress",[hr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),yr=K(gr.prototype,"perTimeProgress",[pr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mr=K(gr.prototype,"lbGold",[fr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),dr=gr));e._RF.pop(),e._RF.push({},"3c2acsRBE9KO4h4sGTiBlRL","zh",void 0),window.i18nConfig||(window.i18nConfig={}),window.i18nConfig.languages||(window.i18nConfig.languages={}),window.i18nConfig.languages.zh={main:{dataLoading:"数据加载中...",dataLoadOver:"数据加载完成...",loginSuccess:"登录成功...",gameResourceLoading:"游戏资源加载中...",audioResourceLoading:"音效资源加载中...",mappingResourceLoading:"贴图资源加载中...",modelResourceLoading:"模型资源加载中...",entering:"正在进入..."},mainUI:{start:"点击屏幕开始",changeCar:"换车"},shop:{btnClose:"关闭",go:"前往",acquired:"已获得",current:"当前",receive:"领取",getGold:"看广告可获取金币"},balance:{"你完成了%{value}个订单":"你完成了%{value}个订单",youEarnedIt:"你赚到了",clickReceive:"点击领取",receiveImmediately:"立即领取"},carTask:{"初始车辆":"初始车辆","分享获得":"分享获得","签到获得":"签到获得","通过关卡获得":"通过关卡获得"},signin:{title:"七日登录",notYet:"暂不领取",normalReceive:"普通领取",receive:"领取",doubleReceive:"双倍领取",fillSignin:"补签"},fightManager:{loadingMap:"正在加载地图...",buildingCity:"开始建造城市...",cityLoadOver:"城市加载完毕..."},fightMap:{trimTheGround:"正在修整地面...",pavingTheRoad:"正在铺路中...",plantingTree:"正在栽树中...",decorateHouse:"正在装修房屋中...",paintLandmarks:"正在粉刷地标中..."},online:{close:"关闭",clickReceive:"点击领取",dailyIncome:"日常收益可领取"},lottery:{title:"幸运大转盘",free:"免费"},talk:{"你好,请到街对面接我.":"你好,请到街对面接我.","停车!停车!":"停车!停车!","去消费最高的地方.":"去消费最高的地方.","去附近的希尔顿酒店.":"去附近的希尔顿酒店.","司机快来!我老婆要生了!":"司机快来!我老婆要生了!","大哥快点,我赶时间.":"大哥快点,我赶时间.","师傅,5分钟内能到吗?":"师傅,5分钟内能到吗?","师傅,你是老司机嘛?":"师傅,你是老司机嘛?","师傅,你跑一天能赚多少?":"师傅,你跑一天能赚多少?","师傅快点,我要赶飞机.":"师傅快点,我要赶飞机.","师傅跟上那辆法拉利.":"师傅跟上那辆法拉利.","带我去最近的银行.":"带我去最近的银行.","帮我跟上前面那辆车!":"帮我跟上前面那辆车!","快去火车站,我赶车!":"快去火车站,我赶车!","我在酒店大堂门口等你.":"我在酒店大堂门口等你.","要下雨了,你快来!":"要下雨了,你快来!"},showReward:{title:"奖励",normalReceive:"普通领取",ReceiveImmediately:" 立即领取",doubleReceive:"双倍领取",alreadyHadCar:"您已拥有该车辆，自动转成对应金币",buySuccessful:"购买成功",confrim:"确认",signinReward:"签到奖励"},revive:{reviveImmediately:"立即复活",skip:"跳过",tips:"真可惜，只差一点就到终点了!",continue:"复活继续"},clickBox:{title:"神秘大礼",progress:"点击越快奖励越多",clickMe:"快点我",normalReceive:"普通领取",doubleReceive:"双倍领取"},trial:{title:"免费试用",tryItNow:"立即试用",giveUp:"放弃试用, 开始游戏"},invinceible:{title:"无敌开局",confirm:"确认",close:"关闭"},setting:{title:"设置",version:"版本号:",close:"关闭"}},e._RF.pop(),e._RF.push({},"4b7cfRS5bdP8qo8rorNgln5","updateValueLabel",void 0);var Tr,Er,Sr,Pr,_r,Ar,Dr,Or,Nr,Mr,Lr,kr,Br,Gr=t.ccclass,Fr=(t.property,t.requireComponent),zr=Gr("updateValueLabel")(Cr=Fr(P)(Cr=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return H(q(t=e.call.apply(e,[this].concat(i))||this),"isPlaying",!1),H(q(t),"startVal",0),H(q(t),"endVal",0),H(q(t),"diffVal",0),H(q(t),"currTime",0),H(q(t),"changingTime",0),H(q(t),"label",null),t}W(t,e);var n=t.prototype;return n.start=function(){},n.playUpdateValue=function(e,t,n){this.startVal=e,this.endVal=t,this.diffVal=this.endVal-this.startVal,this.currTime=0,this.changingTime=n,this.label=this.node.getComponent(P),this.label.string=e.toString(),this.isPlaying=!0},n.update=function(e){if(this.isPlaying){if(this.currTime<this.changingTime){this.currTime+=e;var t=this.startVal+parseInt((this.currTime/this.changingTime*this.diffVal).toString());return t<this.startVal?t=this.startVal:t>this.endVal&&(t=this.endVal),void(this.label.string=""+t)}this.label.string=""+this.endVal,this.isPlaying=!1}},t}(T))||Cr)||Cr;e._RF.pop(),e._RF.push({},"501ddLP5JZNPaa02x+rFKAH","setting",void 0);var Ur,xr,Yr,Vr=t.ccclass,Hr=t.property,Wr=(Tr=Vr("setting"),Er=Hr(D),Sr=Hr(D),Pr=Hr(c),_r=Hr(c),Ar=Hr(P),Tr((Nr=K((Or=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"spVibrateSwitch",Nr,q(t)),X(q(t),"spSoundSwitch",Mr,q(t)),X(q(t),"imgSwitchOpen",Lr,q(t)),X(q(t),"imgSwitchClose",kr,q(t)),X(q(t),"lbVersion",Br,q(t)),H(q(t),"isSoundOpen",void 0),H(q(t),"isVibrateOpen",void 0),H(q(t),"clickTimes",0),t}W(t,e),t.checkState=function(){pe.instance.getConfiguration(!0)?(pe.instance.openMusic(),pe.instance.openSound()):(pe.instance.closeMusic(),pe.instance.closeSound())};var n=t.prototype;return n.start=function(){},n.show=function(){this.clickTimes+=1,this.lbVersion.string=Gi.t("setting.version")+" "+Dt.instance.getVersion(),this.isSoundOpen=pe.instance.getConfiguration(!0),this.isVibrateOpen=Wn.isVibrateOpen(),this.refreshSwitchUI()},n.refreshSwitchUI=function(){this.isVibrateOpen?this.spVibrateSwitch.spriteFrame=this.imgSwitchOpen:this.spVibrateSwitch.spriteFrame=this.imgSwitchClose,this.isSoundOpen?this.spSoundSwitch.spriteFrame=this.imgSwitchOpen:this.spSoundSwitch.spriteFrame=this.imgSwitchClose},n.onBtnVibrateClick=function(){},n.onBtnSoundClick=function(){this.isSoundOpen=!this.isSoundOpen,this.isSoundOpen?(pe.instance.openMusic(),pe.instance.openSound()):(pe.instance.closeMusic(),pe.instance.closeSound()),$.instance.setGlobalData("music",""+this.isSoundOpen),this.refreshSwitchUI()},n.onBtnCloseClick=function(){gn.instance.hideDialog("main/setting")},t}(T)).prototype,"spVibrateSwitch",[Er],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Mr=K(Or.prototype,"spSoundSwitch",[Sr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Lr=K(Or.prototype,"imgSwitchOpen",[Pr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),kr=K(Or.prototype,"imgSwitchClose",[_r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Br=K(Or.prototype,"lbVersion",[Ar],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Dr=Or))||Dr);e._RF.pop(),e._RF.push({},"586a8tdaBhPQprl2rcvzztA","customerManager",void 0);var jr,qr,Xr,Kr,Zr,Jr,Qr,$r,eo,to=t.ccclass,no=t.property,io=to("customerManager")((Yr=K((xr=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"moveSpeed",Yr,q(t)),H(q(t),"nodeCustomer",null),H(q(t),"_targetPos",null),H(q(t),"_callback",void 0),H(q(t),"_offset",null),H(q(t),"customerId",-1),H(q(t),"retryTimes",0),t}W(t,e);var n=t.prototype;return n.start=function(){},n.newOrder=function(){this.customerId=Math.floor(Math.random()*ve.CUSTOMER_MAX_CNT)+1,ue.dispatchEvent("showTalk",this.customerId,ie.CUSTOMER_TALK_TIME.NEW_ORDER)},n.greeting=function(e,t,n){var i=this;-1===this.customerId&&(this.customerId=Math.floor(Math.random()*ve.CUSTOMER_MAX_CNT)+1),this.nodeCustomer&&(Pe.instance.putNode(this.nodeCustomer),this.nodeCustomer=null),he.getCustomer(this.customerId.toString(),(function(r,o){if(r)return console.error(r),void(i.retryTimes<3&&i.greeting(e,t,n));i.retryTimes=0,i.nodeCustomer=Pe.instance.getNode(o,i.node),i.nodeCustomer.active=!0;var a=new b;b.multiplyScalar(a,t,1.3),b.add(a,e,a);var s=a.clone();b.multiplyScalar(a,t,.25),b.add(a,e,a);var l=a.clone();i.nodeCustomer.setWorldPosition(s),0!==t.x?t.x>0?i.nodeCustomer.eulerAngles=new b(0,270,0):i.nodeCustomer.eulerAngles=new b(0,90,0):t.z>0?i.nodeCustomer.eulerAngles=new b(0,180,0):i.nodeCustomer.eulerAngles=new b(0,0,0),pe.instance.playSound(ve.AUDIO_SOUND.NEW_ORDER),i.customerMove(l,(function(){pe.instance.playSound(ve.AUDIO_SOUND.IN_CAR),n&&n(),i.scheduleOnce((function(){ue.dispatchEvent("showTalk",i.customerId,ie.CUSTOMER_TALK_TIME.INTO_THE_CAR)}),1)}))}))},n.takeCustomer=function(e,t,n,i){var r=this;if(this.nodeCustomer){t=new b(t.x,t.y,t.z);var o=new b;b.multiplyScalar(o,t,.25),b.add(o,e,o);var a=o.clone();this.nodeCustomer.active=!0,this.nodeCustomer.setWorldPosition(a),0!==t.x?t.x>0?this.nodeCustomer.eulerAngles=new b(0,90,0):this.nodeCustomer.eulerAngles=new b(0,270,0):t.z>0?this.nodeCustomer.eulerAngles=new b(0,0,0):this.nodeCustomer.eulerAngles=new b(0,180,0),b.multiplyScalar(o,t,1.3),b.add(o,e,o);var s=o.clone();pe.instance.playSound(ve.AUDIO_SOUND.GET_MONEY),this.customerMove(s,(function(){i&&i(),n||r.scheduleOnce((function(){r.newOrder()}),2)}))}else i&&i()},n.customerMove=function(e,t){this._targetPos=e,this._callback=t,this.nodeCustomer.getComponent(O).play("walk"),this._offset=b.subtract(new b,this._targetPos,this.nodeCustomer.worldPosition),this._offset.multiplyScalar(this.moveSpeed)},n.update=function(e){if(this._targetPos&&this.nodeCustomer){var t=this.nodeCustomer.getWorldPosition(),n=new b;b.multiplyScalar(n,this._offset,e),t.add(n),b.subtract(n,t,this._targetPos).lengthSqr()<.01?this.onMoveOver():this.nodeCustomer.setWorldPosition(t)}},n.onMoveOver=function(){this.nodeCustomer.setWorldPosition(this._targetPos),this.nodeCustomer.active=!1,this._targetPos=null,this._callback&&this._callback()},n.reset=function(){this.nodeCustomer&&u(this.nodeCustomer)&&(this.nodeCustomer.getComponent(O).getState("walk").stop(),this.nodeCustomer.destroy(),this.nodeCustomer=null);this.customerId=-1},t}(T)).prototype,"moveSpeed",[no],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Ur=xr))||Ur;e._RF.pop(),e._RF.push({},"5b356wyJ3BCYZpADXUOyafo","onlineDouble",void 0);var ro,oo,ao,so,lo,co,uo,ho,po,fo=t.ccclass,go=t.property;jr=fo("onlineDouble"),qr=go(P),Xr=go(P),Kr=go(D),jr((Qr=K((Jr=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return H(q(t=e.call.apply(e,[this].concat(i))||this),"rewardMoney",0),H(q(t),"overCallback",null),X(q(t),"lbGoldNormal",Qr,q(t)),X(q(t),"lbGoldMulti",$r,q(t)),X(q(t),"spIcon",eo,q(t)),t}W(t,e);var n=t.prototype;return n.start=function(){},n.show=function(e,t){this.rewardMoney=e,this.overCallback=t,this.lbGoldNormal.string=vt.formatMoney(e),this.lbGoldMulti.string=vt.formatMoney(3*e),Wn.updateRewardIcon(ve.SHARE_FUNCTION.ONLINE,this.spIcon)},n.onBtnGetNormalClick=function(){this.rewardOver(this.rewardMoney)},n.onBtnGetMultiClick=function(){var e=this;Wn.openReward(ve.SHARE_FUNCTION.ONLINE,(function(t){t||e.rewardOver(3*e.rewardMoney)}))},n.rewardOver=function(e){Gt.instance.updatePlayerInfo("gold",e),gn.instance.hideDialog("main/onlineDouble"),Wn.showFlyReward(ve.REWARD_TYPE.GOLD,(function(){ue.dispatchEvent("updateGold")})),this.overCallback&&this.overCallback()},n.onBtnCloseClick=function(){gn.instance.hideDialog("main/onlineDouble")},t}(T)).prototype,"lbGoldNormal",[qr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$r=K(Jr.prototype,"lbGoldMulti",[Xr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),eo=K(Jr.prototype,"spIcon",[Kr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Zr=Jr));e._RF.pop(),e._RF.push({},"5bf756By5JOmoKbG0aoUzq6","trial",void 0);var vo,yo,mo,bo,Io,Co,wo,Ro,To,Eo,So,Po,_o,Ao,Do,Oo=t.ccclass,No=t.property;ro=Oo("trial"),oo=No(m),ao=No(k),so=No(D),ro((uo=K((co=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"nodeCarParent",uo,q(t)),X(q(t),"wgMenu",ho,q(t)),H(q(t),"currentCar",null),H(q(t),"carDegree",0),H(q(t),"rotateSpeed",30),H(q(t),"carId",0),X(q(t),"spIcon",po,q(t)),H(q(t),"_callback",void 0),t}W(t,e);var n=t.prototype;return n.start=function(){},n.show=function(e){var t=this;this._callback=e,Wn.updateRewardIcon(ve.SHARE_FUNCTION.TRIAL,this.spIcon),this.currentCar&&(Pe.instance.putNode(this.currentCar),this.currentCar=null);var n=Dt.instance.getCars(),i=[];if(n.forEach((function(e){Gt.instance.hasCar(e.ID)||i.push(e.ID)})),i.length<=0)this.onBtnCloseClick();else{var r=Math.floor(Math.random()*i.length);this.carId=i[r];var o=Dt.instance.queryByID("car",this.carId.toString());he.getUICar(o.model,(function(e,n){e?console.error(e,o.model):(t.carDegree=0,t.currentCar=Pe.instance.getNode(n,t.nodeCarParent))}))}},n.onBtnCloseClick=function(){gn.instance.hideDialog("main/trial"),this._callback&&this._callback()},n.onBtnTrialClick=function(){var e=this;Wn.openReward(ve.SHARE_FUNCTION.TRIAL,(function(t,n){t||(Gt.instance.showCar=e.carId,ue.dispatchEvent("updateCar"),e.onBtnCloseClick())}))},n.update=function(e){this.currentCar&&(this.carDegree-=e*this.rotateSpeed,this.carDegree<=-360&&(this.carDegree+=360),this.currentCar.eulerAngles=new b(0,this.carDegree,0))},t}(T)).prototype,"nodeCarParent",[oo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ho=K(co.prototype,"wgMenu",[ao],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),po=K(co.prototype,"spIcon",[so],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),lo=co));e._RF.pop(),e._RF.push({},"6e662xQs9xPfZ4Gn7vNo4u5","mainUI",void 0);var Mo,Lo,ko,Bo,Go,Fo,zo,Uo,xo,Yo,Vo,Ho,Wo,jo,qo,Xo,Ko,Zo,Jo,Qo,$o,ea,ta,na,ia,ra=t.ccclass,oa=t.property;vo=ra("mainUI"),yo=oa(D),mo=oa(P),bo=oa(m),Io=oa(m),Co=oa(m),wo=oa(m),vo((Eo=K((To=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"spIcon",Eo,q(t)),X(q(t),"lbGold",So,q(t)),X(q(t),"nodeBtnService",Po,q(t)),X(q(t),"nodeSignInRedDot",_o,q(t)),X(q(t),"nodeGoldIcon",Ao,q(t)),X(q(t),"nodeShopRedDot",Do,q(t)),H(q(t),"targetScale",new b(1,1,1)),H(q(t),"isGoldPlaying",!1),H(q(t),"arrCars",[]),H(q(t),"isShowAniFinished",!1),H(q(t),"debugIdx",0),H(q(t),"debugTimer",0),t}W(t,e);var n=t.prototype;return n.start=function(){Wn.afterLogin(),this.updateSignIn()},n.onEnable=function(){ue.on("updateGold",this.updateGold,this),ue.on("updateSignIn",this.updateSignIn,this),ue.on("receiveGold",this.receiveGold,this),ue.on("updateCar",this.updateCar,this),ue.on("buyCar",this.updateCarReceived,this)},n.onDisable=function(){ue.off("updateGold",this.updateGold,this),ue.off("updateSignIn",this.updateSignIn,this),ue.off("receiveGold",this.receiveGold,this),ue.off("updateCar",this.updateCar,this),ue.off("buyCar",this.updateCarReceived,this)},n.updateGold=function(){var e=Gt.instance.playerInfo.gold||0;this.lbGold.string=vt.formatMoney(e)},n.receiveGold=function(){var e=this;this.isGoldPlaying=!0,this.nodeGoldIcon.setScale(new b(1,1,1)),A(this.targetScale).to(.2,new b(1.2,1.2,1.2)).to(.2,new b(1,1,1)).call((function(){e.isGoldPlaying=!1})).start()},n.updateSignIn=function(){Gt.instance.updateSignInCurrentDay();var e=Gt.instance.getSignInReceivedInfo();this.nodeSignInRedDot.active=!e.isAllReceived},n.onBtnBgClick=function(){var e=this;Gt.instance.playerInfo.level>ve.NEWBEE_LEVEL?gn.instance.showDialog("main/trial",[function(){e.askInvincible()}]):this.showStart()},n.askInvincible=function(){var e=this;Gt.instance.playerInfo.level>ve.NEWBEE_LEVEL?gn.instance.showDialog("main/invincible",[function(){e.showStart()}]):this.showStart()},n.showStart=function(){ue.dispatchEvent("startGame")},n.onBtnDailyClick=function(){gn.instance.showDialog("signIn/signIn")},n.onBtnLotteryClick=function(){gn.instance.showDialog("lottery/lottery")},n.onBtnRankClick=function(){gn.instance.showDialog("rank/rank")},n.onBtnChangeCarClick=function(){gn.instance.showDialog("shop/shop")},n.onBtnSettingClick=function(){gn.instance.showDialog("main/setting")},n.updateCar=function(){},n.updateCarReceived=function(){this.nodeShopRedDot.active=Gt.instance.hasCarCanReceived()},n.onBtnLeftClick=function(){var e=Gt.instance.showCar,t=this.arrCars.indexOf(e);--t<0&&(t=this.arrCars.length-1),Gt.instance.showCar=this.arrCars[t],ue.dispatchEvent("updateCar")},n.onBtnRightClick=function(){var e=Gt.instance.showCar,t=this.arrCars.indexOf(e);++t>=this.arrCars.length&&(t=0),Gt.instance.showCar=this.arrCars[t],ue.dispatchEvent("updateCar")},n.show=function(){var e=this;this.updateGold(),this.nodeShopRedDot.active=Gt.instance.hasCarCanReceived(),this.arrCars.length=0,Dt.instance.getCars().forEach((function(t){e.arrCars.push(t.ID)})),this.isShowAniFinished=!0,Wn.updateRewardIcon(ve.SHARE_FUNCTION.TRIAL,this.spIcon,(function(){Gt.instance.hasCar(Gt.instance.showCar)&&(e.spIcon.node.active=!1)})),Gt.instance.isComeFromBalance&&this.onBtnBgClick()},n.update=function(e){(this.isGoldPlaying||1!==this.targetScale.x)&&this.nodeGoldIcon.setScale(this.targetScale)},n.onBtnDebugClick=function(){},t}(T)).prototype,"spIcon",[yo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),So=K(To.prototype,"lbGold",[mo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Po=K(To.prototype,"nodeBtnService",[bo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_o=K(To.prototype,"nodeSignInRedDot",[Io],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ao=K(To.prototype,"nodeGoldIcon",[Co],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Do=K(To.prototype,"nodeShopRedDot",[wo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ro=To));e._RF.pop(),e._RF.push({},"880e1kClIdKPqdXdgTIpdv2","showReward",void 0);var aa,sa,la,ca,ua,ha,pa,fa,da,ga,va,ya,ma,ba,Ia,Ca,wa,Ra=t.ccclass,Ta=t.property;Mo=Ra("showReward"),Lo=Ta(c),ko=Ta(D),Bo=Ta(P),Go=Ta(P),Fo=Ta(P),zo=Ta(P),Uo=Ta(m),xo=Ta(m),Yo=Ta(m),Vo=Ta(m),Ho=Ta(O),Mo((qo=K((jo=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"sfGold",qo,q(t)),X(q(t),"spIcon",Xo,q(t)),X(q(t),"lbRewardValue",Ko,q(t)),X(q(t),"lbTips",Zo,q(t)),X(q(t),"lbTitle",Jo,q(t)),X(q(t),"lbImmediateBtn",Qo,q(t)),X(q(t),"ndCarParent",$o,q(t)),X(q(t),"ndBtnDouble",ea,q(t)),X(q(t),"ndBtnNormal",ta,q(t)),X(q(t),"ndBtnImmediately",na,q(t)),X(q(t),"aniReward",ia,q(t)),H(q(t),"isDouble",!1),H(q(t),"callback",null),H(q(t),"isLast",!1),H(q(t),"rewardType",0),H(q(t),"amount",0),H(q(t),"itemInfo",void 0),H(q(t),"_isHadCar",!1),H(q(t),"currentCar",null),H(q(t),"carDegree",0),H(q(t),"rotateSpeed",30),t}W(t,e);var n=t.prototype;return n.start=function(){},n.show=function(e,t,n,i,r,o){var a=this;this.itemInfo=e,this.rewardType=e.rewardType,this.amount=e.amount,this.ndBtnDouble.active=t,this.ndBtnNormal.active=t,this.ndBtnImmediately.active=!t,this.lbTitle.string=n,this.lbRewardValue.string=e.rewardType===ve.REWARD_TYPE.CAR?"":String(this.amount),this.callback=i,r?(this.lbTips.node.active=!0,this.lbTips.string=r):this.lbTips.node.active=!1,this.showRewardPage(),this.aniReward.play("rewardShow"),this.aniReward.once(O.EventType.FINISHED,(function(){a.aniReward.play("rewardIdle")}),this),this.lbImmediateBtn.string=o||Gi.t("balance.receiveImmediately")},n.showRewardPage=function(){var e=this;switch(this.currentCar&&(Pe.instance.putNode(this.currentCar),this.currentCar=null),this.rewardType){case ve.REWARD_TYPE.DIAMOND:break;case ve.REWARD_TYPE.GOLD:this.spIcon.spriteFrame=this.sfGold,this.spIcon.node.active=!0;break;case ve.REWARD_TYPE.CAR:this.spIcon.node.active=!1;var t=Dt.instance.queryByID("car",this.itemInfo.ID).model;he.getUICar(t,(function(t,n){t?console.error(t):(e.currentCar=Pe.instance.getNode(n,e.ndCarParent),e.carDegree=0)}))}},n.onBtnNormalClick=function(){this.addReward()},n.onBtnDoubleClick=function(){var e=this;Wn.openReward(ve.SHARE_FUNCTION.SIGNIN,(function(t){t||(e.amount*=2,e.addReward())}))},n.onBtnImmediatelyClick=function(){this.addReward()},n.addReward=function(){switch(this.rewardType){case ve.REWARD_TYPE.DIAMOND:break;case ve.REWARD_TYPE.GOLD:Gt.instance.updatePlayerInfo("gold",this.amount),Wn.showFlyReward(ve.REWARD_TYPE.GOLD,(function(){ue.dispatchEvent("updateGold")}));break;case ve.REWARD_TYPE.CAR:Wn.buyCar(this.itemInfo.ID)}gn.instance.hideDialog("common/showReward"),this.callback&&this.callback()},n.update=function(e){this.currentCar&&(this.carDegree-=e*this.rotateSpeed,this.carDegree<=-360&&(this.carDegree+=360),this.currentCar.eulerAngles=new b(0,this.carDegree,0))},t}(T)).prototype,"sfGold",[Lo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xo=K(jo.prototype,"spIcon",[ko],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ko=K(jo.prototype,"lbRewardValue",[Bo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Zo=K(jo.prototype,"lbTips",[Go],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Jo=K(jo.prototype,"lbTitle",[Fo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qo=K(jo.prototype,"lbImmediateBtn",[zo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$o=K(jo.prototype,"ndCarParent",[Uo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ea=K(jo.prototype,"ndBtnDouble",[xo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ta=K(jo.prototype,"ndBtnNormal",[Yo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),na=K(jo.prototype,"ndBtnImmediately",[Vo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ia=K(jo.prototype,"aniReward",[Ho],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Wo=jo));e._RF.pop(),e._RF.push({},"884dcSQc2hHsJby3+7ljIyd","clickBox",void 0);var Ea,Sa,Pa,_a,Aa,Da,Oa,Na,Ma,La,ka,Ba,Ga,Fa,za,Ua,xa,Ya,Va,Ha,Wa,ja,qa,Xa=t.ccclass,Ka=t.property;aa=Xa("clickBox"),sa=Ka(B),la=Ka(m),ca=Ka(P),ua=Ka(m),ha=Ka(m),pa=Ka(m),fa=Ka(D),aa((va=K((ga=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"progress",va,q(t)),X(q(t),"nodeReward",ya,q(t)),X(q(t),"lbReward",ma,q(t)),X(q(t),"nodeBox",ba,q(t)),X(q(t),"nodeMenu",Ia,q(t)),X(q(t),"nodeClickBtn",Ca,q(t)),X(q(t),"spIcon",wa,q(t)),H(q(t),"scheduleTime",0),H(q(t),"curProgress",50),H(q(t),"clickTimes",15),H(q(t),"curClick",0),H(q(t),"isOpenBox",!1),H(q(t),"rewardValue",0),t}W(t,e);var n=t.prototype;return n.start=function(){},n.show=function(){this.scheduleTime=0,this.curProgress=50,this.clickTimes=10+Math.floor(5*Math.random()),this.curClick=0,this.isOpenBox=!1,this.nodeClickBtn.active=!0,this.progress.node.active=!0,this.nodeBox.active=!0,this.nodeReward.active=!1,this.nodeMenu.active=!1,Wn.updateRewardIcon(ve.SHARE_FUNCTION.CLICK_BOX,this.spIcon)},n.onBtnBoxClick=function(){this.isOpenBox||(this.curClick++,this.curClick>this.clickTimes?(this.isOpenBox=!0,this.showReward()):(this.curProgress+=20,this.curProgress=this.curProgress>100?100:this.curProgress))},n.showReward=function(){this.nodeClickBtn.active=!1,this.progress.node.active=!1,this.nodeBox.active=!1,this.nodeReward.active=!0,this.nodeMenu.active=!0,this.lbReward.string="+"+ie.CLICK_BOX_REWARD,this.rewardValue=ie.CLICK_BOX_REWARD},n.update=function(e){this.scheduleTime+=e,this.scheduleTime>=.1&&(this.curProgress-=3,this.curProgress=this.curProgress<0?0:this.curProgress,this.scheduleTime=0),this.progress.progress=this.curProgress/100},n.onBtnNormalClick=function(){Wn.addGold(ie.CLICK_BOX_REWARD),this.close()},n.onBtnDoubleClick=function(){var e=this;Wn.openReward(ve.SHARE_FUNCTION.CLICK_BOX,(function(t){t||(Wn.addGold(2*ie.CLICK_BOX_REWARD),e.close())}))},n.close=function(){gn.instance.hideDialog("fight/clickBox")},t}(T)).prototype,"progress",[sa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ya=K(ga.prototype,"nodeReward",[la],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ma=K(ga.prototype,"lbReward",[ca],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ba=K(ga.prototype,"nodeBox",[ua],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ia=K(ga.prototype,"nodeMenu",[ha],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ca=K(ga.prototype,"nodeClickBtn",[pa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),wa=K(ga.prototype,"spIcon",[fa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),da=ga));e._RF.pop(),e._RF.push({},"8a6efh8jF9Js7ZZXyAL57KG","signInItem",void 0);var Za,Ja,Qa,$a=t.ccclass,es=t.property,ts=(Ea=$a("signInItem"),Sa=es(c),Pa=es(c),_a=es(D),Aa=es(c),Da=es(m),Oa=es(m),Na=es(m),Ma=es(P),La=es(m),ka=es(P),Ea((Fa=K((Ga=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"sfBgBlue",Fa,q(t)),X(q(t),"sfYellow",za,q(t)),X(q(t),"spReward",Ua,q(t)),X(q(t),"sfGold",xa,q(t)),X(q(t),"nodeTick",Ya,q(t)),X(q(t),"nodeBtnFillSign",Va,q(t)),X(q(t),"nodeBtnAfterFillSign",Ha,q(t)),X(q(t),"lbDayIndex",Wa,q(t)),X(q(t),"nodeLight",ja,q(t)),X(q(t),"lbValue",qa,q(t)),H(q(t),"_parent",null),H(q(t),"itemInfo",null),H(q(t),"isHadCar",null),t}W(t,e);var n=t.prototype;return n.start=function(){},n.init=function(e,t){this._parent=t,this.itemInfo=e,this.lbValue.string=e.rewardType===ve.REWARD_TYPE.CAR?"":String(e.amount),this.lbDayIndex.string=String(e.ID),this.setIcon(e.rewardType),this.setStatus(e.status),this.node.getComponent(D).spriteFrame=Number(e.ID)>=7?this.sfBgBlue:this.sfYellow},n.setIcon=function(e){switch(e){case ve.REWARD_TYPE.DIAMOND:break;case ve.REWARD_TYPE.GOLD:this.spReward.spriteFrame=this.sfGold;break;case ve.REWARD_TYPE.CAR:var t=Dt.instance.queryByID("car",this.itemInfo.amount).model;Gt.instance.isHadCarAndDuringPeriod(this.itemInfo.amount)?(this.spReward.spriteFrame=this.sfGold,2==this.itemInfo.ID?this.lbValue.string=String(ve.GOLD_REWARD.SECOND):7==this.itemInfo.ID&&(this.lbValue.string=String(ve.GOLD_REWARD.SEVENT))):he.setCarIcon(t,this.spReward,!1,(function(){}))}},n.setStatus=function(e){switch(e){case ve.SIGNIN_REWARD_STATUS.RECEIVED:this.showItemUI(!1,!0,!1,!1);break;case ve.SIGNIN_REWARD_STATUS.RECEIVABLE:this.showItemUI(!0,!1,!1,!1);break;case ve.SIGNIN_REWARD_STATUS.UNRECEIVABLE:this.showItemUI(!1,!1,!1,!1);break;case ve.SIGNIN_REWARD_STATUS.FILL_SIGNIN:this.showItemUI(!1,!1,!0,!1);break;case ve.SIGNIN_REWARD_STATUS.AFTER_FILL_SIGNIN:this.showItemUI(!0,!1,!1,!0)}},n.showItemUI=function(e,t,n,i){this.nodeLight.active=e;var r=this.nodeLight.getComponent(O);e?r.play():r.stop(),this.nodeTick.active=t,this.nodeBtnFillSign.active=n,this.nodeBtnAfterFillSign.active=i},n.onBtnAfterFillSignClick=function(){this.itemInfo.status!==ve.SIGNIN_REWARD_STATUS.AFTER_FILL_SIGNIN&&this.itemInfo.status!==ve.SIGNIN_REWARD_STATUS.RECEIVABLE||this._parent.receiveReward(this.itemInfo,!1,this.markReceived.bind(this))},n.markReceived=function(){this.itemInfo.status=ve.SIGNIN_REWARD_STATUS.RECEIVED,this.setStatus(this.itemInfo.status),2!==this.itemInfo.ID&&7!==this.itemInfo.ID||this.isHadCar||Gt.instance.updateDictGetCarTime(this.itemInfo.amount),this.itemInfo.ID&&(Gt.instance.updateSignInReceivedDays(this.itemInfo.ID),ue.dispatchEvent("updateSignIn")),this.close()},n.close=function(){gn.instance.shiftFromPopupSeq("common/showReward"),Gt.instance.getSignInReceivedInfo().isAllReceived?gn.instance.shiftFromPopupSeq("common/showReward"):gn.instance.pushToPopupSeq("signIn/signIn","signIn",{})},n.markAfterFillSignIn=function(){this.itemInfo.status=ve.SIGNIN_REWARD_STATUS.AFTER_FILL_SIGNIN,this.setStatus(this.itemInfo.status),Gt.instance.updateSignInFillSignInDays(this.itemInfo.ID,!1)},n.onBtnFillSignInClick=function(){var e=this;Wn.openReward(ve.SHARE_FUNCTION.FILL_SIGNIN,(function(t){t||e.markAfterFillSignIn()}))},t}(T)).prototype,"sfBgBlue",[Sa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),za=K(Ga.prototype,"sfYellow",[Pa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ua=K(Ga.prototype,"spReward",[_a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xa=K(Ga.prototype,"sfGold",[Aa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ya=K(Ga.prototype,"nodeTick",[Da],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Va=K(Ga.prototype,"nodeBtnFillSign",[Oa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ha=K(Ga.prototype,"nodeBtnAfterFillSign",[Na],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Wa=K(Ga.prototype,"lbDayIndex",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ja=K(Ga.prototype,"nodeLight",[La],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),qa=K(Ga.prototype,"lbValue",[ka],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ba=Ga))||Ba);e._RF.pop(),e._RF.push({},"8cbacDdVTBOgZQMyvQzOeAz","lodash",void 0);var ns,is,rs,os,as,ss,ls,cs,us,hs=(0,t.ccclass)("lodash")((Qa=Ja=function(){function e(){}return e.find=function(e,t){var n;if(Array.isArray(e)||(e=this.toArray(e)),(n=e.filter(t)).length)return n[0]},e.forEach=function(e,t){Array.isArray(e)?e.forEach(t):this.toArrayKey(e).forEach((function(n,i,r){var o=n.key,a=n.value;t(a,o,e)}))},e.cloneDeep=function(e){if(null===e||"object"!=typeof e)return e;var t={};for(var n in e.constructor===Array&&(t=[]),e)e.hasOwnProperty(n)&&(t[n]=this.cloneDeep(e[n]));return t},e.map=function(e,t){Array.isArray(e)||(e=this.toArray(e));var n=[];return e.forEach((function(e,i,r){n.push(t(e,i,r))})),n},e.random=function(e,t){var n=Math.random()*(t-e+1)+e;return Math.floor(n)},e.toArrayKey=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({key:n,value:e[n]});return t},e.toArray=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},e.filter=function(e,t){return Array.isArray(e)||(e=this.toArray(e)),e.filter(t)},e.isEqual=function(e,t){if(!(e instanceof Object)||!(t instanceof Object))return e===t;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e){var i=e[n]instanceof Object,r=t[n]instanceof Object;if(i&&r)return this.isEqual(e[n],t[n]);if(e[n]!==t[n])return!1}return!0},e.pullAllWith=function(e,t,n){return t.forEach((function(t){e.filter((function(e){return n(e,t)})).forEach((function(t){var n=e.indexOf(t);-1!==e.indexOf(t)&&e.splice(n,1)}))})),e},e.now=function(){return Date.now()},e.pullAll=function(e,t){return t.forEach((function(t){var n=e.indexOf(t);-1!==e.indexOf(t)&&e.splice(n,1)})),e},e.forEachRight=function(e,t){Array.isArray(e)||(e=this.toArray(e));for(var n=e.length-1;n>=0;n--){if(!t(e[n]))break}},e.startsWith=function(e,t,n){return(e=e.substr(n)).startsWith(t)},e.endsWith=function(e,t,n){return(e=e.substr(n)).endsWith(t)},e.remove=function(e,t){var n=[],i=[];return e.forEach((function(e,r){t(e)&&(n.push(e),i.push(r))})),this.basePullAt(e,i),n},e.basePullAt=function(e,t){for(var n,i=e?t.length:0,r=i-1;i--;){var o=t[i];i!==r&&o===n||(n=o,Array.prototype.splice.call(e,o,1))}return e},e.findIndex=function(e,t,n){var i;if(e=e.slice(n),"function"==typeof t){for(i=0;i<e.length;i++)if(t(e[i]))return i}else if(Array.isArray(t))for(i=0;i<e.length;i++){var r=t[0],o=!0;if(t.length>1&&(o=t[1]),e[i][r]===o)return i}else for(i=0;i<e.length;i++)if(e[i]===t)return i;return-1},e.concat=function(){var e=arguments.length;if(!e)return[];for(var t=arguments[0],n=1;n<e;)t=t.concat(arguments[n]),n++;return t},e.isNumber=function(e){return"number"==typeof e},e.indexOf=function(e,t,n){return(e=e.slice(n)).indexOf(t)},e.join=function(e,t){if(null===e)return"";var n="";return e.forEach((function(e){n+=e+t})),n.substr(0,n.length-1)},e.split=function(e,t,n){return e.split(t,n)},e.max=function(e){if(e&&e.length){for(var t,n=0;n<e.length;n++)0===n?t=e[0]:t<e[n]&&(t=e[n]);return t}},e.drop=function(e,t){return(null===e?0:e.length)?e.slice(t):[]},e.flattenDeep=function(e){return e.reduce((function(e,t){return e.concat(t)}))},e.uniq=function(e){var t=[];return e.forEach((function(e){-1===t.indexOf(e)&&t.push(e)})),t},e.isNaN=function(e){return this.isNumber(e)&&e!==+e},e.chunk=function(e,t){if(!(null===e?0:e.length)||t<1)return[];for(var n=[];e.length>t;)n.push(e.slice(0,t)),e=e.slice(t);return n.push(e),n},e.toFinite=function(e){var t=1/0;return e?(e=Number(e))===t||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0},e.baseRange=function(e,t,n,i){for(var r=-1,o=(0,Math.max)((0,Math.ceil)((t-e)/(n||1)),0),a=Array(o);o--;)a[i?o:++r]=e,e+=n;return a},e.isObject=function(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)},e.isLength=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=e.MAX_SAFE_INTEGER},e.isArrayLike=function(e){return null!==e&&this.isLength(e.length)},e.eq=function(e,t){return e===t||e!=e&&t!=t},e.isIndex=function(t,n){var i=typeof t;return!!(n=null===n?e.MAX_SAFE_INTEGER:n)&&("number"===i||"symbol"!==i&&/^(?:0|[1-9]\d*)$/.test(t))&&t>-1&&t%1==0&&t<n},e.isIterateeCall=function(e,t,n){if(!this.isObject(n))return!1;var i=typeof t;return!!("number"===i?this.isArrayLike(n)&&this.isIndex(t,n.length):"string"===i&&t in n)&&this.eq(n[t],e)},e.createRange=function(e){var t=this;return function(n,i,r){return r&&"number"!=typeof r&&t.isIterateeCall(n,i,r)&&(i=r=void 0),n=t.toFinite(n),void 0===i?(i=n,n=0):i=t.toFinite(i),r=void 0===r?n<i?1:-1:t.toFinite(r),t.baseRange(n,i,r,e)}.bind(this)},e.maxBy=function(e,t){if(e&&e.length){for(var n=-1,i=-1,r=0;r<e.length;r++)0===r?(n=t(e[0]),i=e[0]):n<e[r]&&(n=e[r],i=e[r]);return i}},e.minBy=function(e,t){if(e&&e.length){for(var n=-1,i=-1,r=0;r<e.length;r++)0===r?(n=t(e[0]),i=e[0]):n>e[r]&&(n=t(e[r]),i=e[r]);return i}},e.sumBy=function(e,t){var n=0;for(var i in e)n+=t(e[i]);return n},e.countBy=function(e){var t={};for(var n in e){var i=e[n];t.hasOwnProperty(i)?t[i]+=1:t[i]=1}return t},e}(),H(Ja,"MAX_SAFE_INTEGER",9007199254740991),Za=Qa))||Za;e._RF.pop(),e._RF.push({},"93fc8seXTpPJqvHF6Jlpios","lotteryItem",void 0);var ps,fs,ds,gs,vs,ys,ms,bs,Is,Cs=t.ccclass,ws=t.property,Rs=(ns=Cs("lotteryItem"),is=ws(c),rs=ws(D),os=ws(P),ns((ls=K((ss=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"imgGold",ls,q(t)),X(q(t),"spItem",cs,q(t)),X(q(t),"lbValue",us,q(t)),H(q(t),"carInfo",void 0),t}W(t,e);var n=t.prototype;return n.start=function(){},n.show=function(e){this.carInfo=Dt.instance.queryByID("car",e),he.setCarIcon(this.carInfo.model,this.spItem,!1,(function(){}))},n.showReward=function(e){if(console.log(this.carInfo.ID),Gt.instance.hasCar(this.carInfo.ID)){var t={rewardType:ve.REWARD_TYPE.GOLD,amount:ve.LOTTERY.EXCHANGE,ID:this.carInfo.ID};gn.instance.showDialog("common/showReward",[t,!1,Gi.t("showReward.title"),function(){},Gi.t("showReward.alreadyHadCar")])}else{var n={rewardType:ve.REWARD_TYPE.CAR,amount:1,ID:this.carInfo.ID};gn.instance.showDialog("common/showReward",[n,!1,Gi.t("showReward.title"),function(){e.receiveCarTimes+=1}])}},t}(T)).prototype,"imgGold",[is],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),cs=K(ss.prototype,"spItem",[rs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),us=K(ss.prototype,"lbValue",[os],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),as=ss))||as);e._RF.pop(),e._RF.push({},"95f63L653dBgLBdIgYWzpHv","revive",void 0);var Ts,Es=t.ccclass,Ss=t.property;ps=Es("revive"),fs=Ss(D),ds=Ss(D),gs=Ss(k),ps((ms=K((ys=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"spCountDown",ms,q(t)),X(q(t),"spIcon",bs,q(t)),X(q(t),"wgMenu",Is,q(t)),H(q(t),"closeCb",null),H(q(t),"countDownTime",0),H(q(t),"currentTime",0),H(q(t),"isCountDowning",!1),t}W(t,e);var n=t.prototype;return n.start=function(){},n.show=function(e){this.closeCb=e,this.countDownTime=5,this.currentTime=0,this.spCountDown.fillRange=1,this.isCountDowning=!0,Wn.updateRewardIcon(ve.SHARE_FUNCTION.RELIVE,this.spIcon)},n.onBtnReviveClick=function(){var e=this;this.isCountDowning=!1,Wn.openReward(ve.SHARE_FUNCTION.RELIVE,(function(t){t?e.isCountDowning=!0:(ue.dispatchEvent("revive"),gn.instance.hideDialog("fight/revive"))}))},n.onBtnSkipClick=function(){this.isCountDowning=!1,gn.instance.hideDialog("fight/revive"),this.closeCb&&this.closeCb()},t}(T)).prototype,"spCountDown",[fs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),bs=K(ys.prototype,"spIcon",[ds],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Is=K(ys.prototype,"wgMenu",[gs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),vs=ys));e._RF.pop(),e._RF.push({},"968ba6c9F9AupY/AbKjAj++","blockInputEvent",void 0);var Ps,_s,As,Ds,Os,Ns=t.ccclass;t.property,Ns("blockInputEvent")(Ts=function(e){function t(){return e.apply(this,arguments)||this}W(t,e);var n=t.prototype;return n.start=function(){},n.onEnable=function(){this.node.on(m.EventType.TOUCH_START,this.stopPropagation,this),this.node.on(m.EventType.TOUCH_END,this.stopPropagation,this),this.node.on(m.EventType.TOUCH_MOVE,this.stopPropagation,this),this.node.on(m.EventType.TOUCH_CANCEL,this.stopPropagation,this),this.node.on(m.EventType.MOUSE_DOWN,this.stopPropagation,this),this.node.on(m.EventType.MOUSE_ENTER,this.stopPropagation,this),this.node.on(m.EventType.MOUSE_MOVE,this.stopPropagation,this),this.node.on(m.EventType.MOUSE_LEAVE,this.stopPropagation,this),this.node.on(m.EventType.MOUSE_UP,this.stopPropagation,this),this.node.on(m.EventType.MOUSE_WHEEL,this.stopPropagation,this)},n.onDisable=function(){this.node.off(m.EventType.TOUCH_START,this.stopPropagation,this),this.node.off(m.EventType.TOUCH_END,this.stopPropagation,this),this.node.off(m.EventType.TOUCH_MOVE,this.stopPropagation,this),this.node.off(m.EventType.TOUCH_CANCEL,this.stopPropagation,this),this.node.off(m.EventType.MOUSE_DOWN,this.stopPropagation,this),this.node.off(m.EventType.MOUSE_ENTER,this.stopPropagation,this),this.node.off(m.EventType.MOUSE_MOVE,this.stopPropagation,this),this.node.off(m.EventType.MOUSE_LEAVE,this.stopPropagation,this),this.node.off(m.EventType.MOUSE_UP,this.stopPropagation,this),this.node.off(m.EventType.MOUSE_WHEEL,this.stopPropagation,this)},n.stopPropagation=function(e){e.propagationImmediateStopped=!0,e.propagationStopped=!0},t}(T));e._RF.pop(),e._RF.push({},"98dcdQl8GhEYLJRG8ap+Eh+","GameRoot",void 0);var Ms,Ls,ks,Bs,Gs,Fs,zs,Us=t.ccclass,xs=t.property;Ps=Us("GameRoot"),_s=xs(G),Ps((Os=K((Ds=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"_audioSource",Os,q(t)),t}W(t,e);var n=t.prototype;return n.onLoad=function(){var e=this.getComponent(G);f(e),this._audioSource=e,F.addPersistRootNode(this.node),pe.instance.init(this._audioSource)},n.onEnable=function(){pe.instance.playMusic(!0),Wr.checkState()},n.start=function(){cocosAnalytics&&cocosAnalytics.enableDebug(!0)},t}(T)).prototype,"_audioSource",[_s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),As=Ds));e._RF.pop(),e._RF.push({},"99c5fx0klFHq52oGPdZL7Z5","loading",void 0);var Ys,Vs,Hs,Ws,js,qs,Xs,Ks,Zs,Js,Qs,$s,el,tl,nl,il,rl,ol,al,sl,ll,cl,ul,hl,pl,fl,dl,gl,vl,yl,ml,bl=t.ccclass,Il=t.property,Cl=(Ms=bl("loading"),Ls=Il(zr),ks=Il(P),Ms((Fs=K((Gs=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"lbProgress",Fs,q(t)),X(q(t),"lbTips",zs,q(t)),H(q(t),"targetProgress",0),H(q(t),"oriPos",new b),t}W(t,e);var n=t.prototype;return n.start=function(){this.show(0)},n.show=function(e){this.targetProgress=e||0,this.lbProgress.playUpdateValue(this.targetProgress,this.targetProgress,0),this.lbProgress.isPlaying=!1,this.lbTips.string="",this.oriPos.set(this.lbProgress.node.position)},n.updateProgress=function(e,t){this.targetProgress=e;var n=Number(this.lbProgress.label.string);this.lbProgress.playUpdateValue(n,this.targetProgress,(this.targetProgress-n)/20),t&&(this.lbTips.string=t),this.oriPos&&this.lbProgress.node.setPosition(new b(this.oriPos.x-10,this.oriPos.y,this.oriPos.z))},t}(T)).prototype,"lbProgress",[Ls],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),zs=K(Gs.prototype,"lbTips",[ks],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Bs=Gs))||Bs);e._RF.pop(),e._RF.push({},"9d016bBiB5J1prtR6VcBPd4","signIn",void 0);var wl,Rl,Tl,El,Sl,Pl,_l,Al,Dl,Ol,Nl,Ml,Ll,kl,Bl,Gl,Fl,zl,Ul,xl,Yl,Vl,Hl,Wl,jl,ql,Xl,Kl,Zl,Jl,Ql,$l,ec,tc,nc,ic=t.ccclass,rc=t.property;Ys=ic("signIn"),Vs=rc(m),Hs=rc(m),Ws=rc(m),js=rc(m),qs=rc(m),Xs=rc(m),Ks=rc(D),Zs=rc(D),Js=rc(c),Qs=rc(c),$s=rc(c),el=rc(c),tl=rc(m),nl=rc(a),Ys((ol=K((rl=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"ndBtnNormal",ol,q(t)),X(q(t),"ndBtnDouble",al,q(t)),X(q(t),"ndBtnReceive",sl,q(t)),X(q(t),"ndReceiveIconn",ll,q(t)),X(q(t),"ndBtnClose",cl,q(t)),X(q(t),"ndBtnNotYet",ul,q(t)),X(q(t),"spDoubleBtnIcon",hl,q(t)),X(q(t),"spReceiveBtnIcon",pl,q(t)),X(q(t),"sfBlue",fl,q(t)),X(q(t),"sfGray",dl,q(t)),X(q(t),"sfVideo",gl,q(t)),X(q(t),"sfShare",vl,q(t)),X(q(t),"arrNodeDay",yl,q(t)),X(q(t),"pbSignInItem",ml,q(t)),H(q(t),"currentDay",0),H(q(t),"arrReceived",[]),H(q(t),"arrAfterFillSignIn",[]),H(q(t),"isTodayReceived",!1),H(q(t),"isAllReceived",!1),H(q(t),"arrSignInItemScript",[]),H(q(t),"currentReward",void 0),H(q(t),"currentRewardType",void 0),H(q(t),"isHadCar",void 0),H(q(t),"createDate",void 0),H(q(t),"getCarDate",void 0),t}W(t,e);var n=t.prototype;return n.start=function(){},n.show=function(){Gt.instance.updateSignInCurrentDay();var e=Gt.instance.playerInfo.signInInfo;this.currentDay=e.currentDay,this.arrReceived=e.receivedDays,this.arrAfterFillSignIn=e.afterFillSignInDays,Wn.updateRewardIcon(ve.SHARE_FUNCTION.SIGNIN,this.spDoubleBtnIcon),Wn.updateRewardIcon(ve.SHARE_FUNCTION.SIGNIN,this.spReceiveBtnIcon),this.showSignInInfo(),this.setButtonStyle(),this.ndReceiveIconn.active=!0},n.setButtonStyle=function(){var e=Gt.instance.getSignInReceivedInfo();this.isTodayReceived=e.isTodayReceived,this.isAllReceived=e.isAllReceived,this.ndBtnDouble.getComponent(D).spriteFrame=this.isTodayReceived?this.sfGray:this.sfBlue,this.ndBtnDouble.getComponent(M).interactable=!this.isTodayReceived,this.ndBtnReceive.getComponent(D).spriteFrame=this.isTodayReceived?this.sfGray:this.sfBlue,this.ndBtnReceive.getComponent(M).interactable=!this.isTodayReceived;var t=Dt.instance.getTableArr("signIn");this.currentReward=t[this.currentDay-1],this.currentRewardType=this.currentReward.rewardType,this.currentRewardType===ve.REWARD_TYPE.CAR?Gt.instance.isHadCarAndDuringPeriod(this.currentReward.amount)?(this.ndBtnDouble.active=!0,this.ndBtnReceive.active=!1,this.ndBtnNormal.active=!this.isTodayReceived,this.ndBtnNotYet.active=!1):(this.ndBtnDouble.active=!1,this.ndBtnReceive.active=!0,this.ndBtnNormal.active=!1,this.ndBtnNotYet.active=!this.isTodayReceived):(this.ndBtnDouble.active=!0,this.ndBtnReceive.active=!1,this.ndBtnNormal.active=!this.isTodayReceived,this.ndBtnNotYet.active=!1)},n.showSignInInfo=function(){this.arrSignInItemScript=[];for(var e=Dt.instance.getTableArr("signIn"),t=0;t<e.length;t++){var n=e[t].ID,i=!!this.arrReceived.includes(n);n<=this.currentDay?(e[t].status=i?ve.SIGNIN_REWARD_STATUS.RECEIVED:ve.SIGNIN_REWARD_STATUS.RECEIVABLE,e[t].status===ve.SIGNIN_REWARD_STATUS.RECEIVABLE&&n<this.currentDay&&(e[t].status=ve.SIGNIN_REWARD_STATUS.FILL_SIGNIN,this.arrAfterFillSignIn.includes(n)&&(e[t].status=ve.SIGNIN_REWARD_STATUS.AFTER_FILL_SIGNIN))):e[t].status=ve.SIGNIN_REWARD_STATUS.UNRECEIVABLE;var r=this.arrNodeDay[t],o=null;r.getChildByName("signInItem")?o=r.getChildByName("signInItem"):(o=s(this.pbSignInItem),r.addChild(o));var a=o.getComponent(ts);a.init(e[t],this),this.arrSignInItemScript.includes(a)||this.arrSignInItemScript.push(a)}},n.receiveReward=function(e,t,n){var i=e.ID;if(!(this.currentDay<i)){var r=Gi.t("showReward.signinReward"),o=vt.clone(e);if(2==e.ID||7==e.ID){var a=Dt.instance.queryByID("car",e.amount);o.ID=a.ID,-1!==Gt.instance.playerInfo.cars.indexOf(a.ID)&&(o.rewardType=ve.REWARD_TYPE.GOLD,o.amount=2==e.ID?ve.GOLD_REWARD.SECOND:ve.GOLD_REWARD.SEVENT)}if(o.amount=t?o.amount*=2:o.amount,gn.instance.shiftFromPopupSeq("signIn/signIn"),o.rewardType===ve.REWARD_TYPE.GOLD)return Gt.instance.updatePlayerInfo("gold",o.amount),Wn.showFlyReward(ve.REWARD_TYPE.GOLD,(function(){ue.dispatchEvent("updateGold")})),void(n&&n());gn.instance.pushToPopupSeq("common/showReward","showReward",[o,!1,r,n])}},n.receiveClick=function(e){for(var t=this,n=function(n){var i=t.arrSignInItemScript[n];if(i.itemInfo.status===ve.SIGNIN_REWARD_STATUS.RECEIVABLE)return i._parent.receiveReward(i.itemInfo,e,(function(){i.markReceived()})),"break"},i=0;i<this.arrSignInItemScript.length;i++){if("break"===n(i))break}},n.onBtnDoubleClick=function(){var e=this;Wn.openReward(ve.SHARE_FUNCTION.SIGNIN,(function(t){t||e.receiveClick(!0)}))},n.onBtnNormalClick=function(){this.receiveClick(!1)},n.onBtnReceiveClick=function(){var e=this;Wn.openReward(ve.SHARE_FUNCTION.SIGNIN,(function(t){t||e.receiveClick(!1)}))},n.onBtnCloseClick=function(){gn.instance.shiftFromPopupSeq("signIn/signIn")},t}(T)).prototype,"ndBtnNormal",[Vs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),al=K(rl.prototype,"ndBtnDouble",[Hs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),sl=K(rl.prototype,"ndBtnReceive",[Ws],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ll=K(rl.prototype,"ndReceiveIconn",[js],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),cl=K(rl.prototype,"ndBtnClose",[qs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ul=K(rl.prototype,"ndBtnNotYet",[Xs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),hl=K(rl.prototype,"spDoubleBtnIcon",[Ks],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pl=K(rl.prototype,"spReceiveBtnIcon",[Zs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fl=K(rl.prototype,"sfBlue",[Js],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),dl=K(rl.prototype,"sfGray",[Qs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),gl=K(rl.prototype,"sfVideo",[$s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),vl=K(rl.prototype,"sfShare",[el],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),yl=K(rl.prototype,"arrNodeDay",[tl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ml=K(rl.prototype,"pbSignInItem",[nl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),il=rl));e._RF.pop(),e._RF.push({},"b6b06mpFMlIZqLpxXisU3Cu","balance",void 0);var oc,ac,sc,lc,uc,hc=t.ccclass,pc=t.property;wl=hc("balance"),Rl=pc(D),Tl=pc(D),El=pc({type:P}),Sl=pc({type:P}),Pl=pc(k),_l=pc({type:m,displayName:"进度项"}),Al=pc(c),Dl=pc(c),Ol=pc(c),Nl=pc(c),Ml=pc(c),Ll=pc(P),kl=pc(P),Bl=pc(P),Gl=pc(D),Fl=pc(m),wl((xl=K((Ul=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"spStart",xl,q(t)),X(q(t),"spEnd",Yl,q(t)),X(q(t),"lbCurLevel",Vl,q(t)),X(q(t),"lbTargetLevel",Hl,q(t)),X(q(t),"wgMenu",Wl,q(t)),X(q(t),"progress",jl,q(t)),X(q(t),"imgLevelFinished",ql,q(t)),X(q(t),"imgLevelUnfinished",Xl,q(t)),X(q(t),"imgProgressNoActive",Kl,q(t)),X(q(t),"imgProgressActive",Zl,q(t)),X(q(t),"imgProgressFinished",Jl,q(t)),X(q(t),"lbTakeCount",Ql,q(t)),X(q(t),"lbGetNormal",$l,q(t)),X(q(t),"lbGetMulti",ec,q(t)),X(q(t),"spIcon",tc,q(t)),X(q(t),"nodeDouble",nc,q(t)),H(q(t),"rewardMoney",0),H(q(t),"isFinishLevel",!1),H(q(t),"showBalanceTimes",0),t}W(t,e);var n=t.prototype;return n.start=function(){},n.show=function(e,t,n,i,r,o){this.showBalanceTimes++;for(var a=n?t:t-1,s=this.progress.length,l=0;l<i&&!(i>=s);l++)this.progress[l].active=!0,this.progress[l].getComponent(D).spriteFrame=l<a?this.imgProgressFinished:this.imgProgressNoActive;n||(this.progress[a].getComponent(D).spriteFrame=this.imgProgressActive);for(var c=i;c<this.progress.length;c++)this.progress[c].active=!1;this.lbCurLevel.string=e.toString(),this.lbTargetLevel.string=""+(e+1),this.isFinishLevel=o,this.spStart.spriteFrame=this.imgLevelFinished,this.spEnd.spriteFrame=o?this.imgLevelFinished:this.imgLevelUnfinished;var u=a>=0?a:0;this.lbTakeCount.string=Gi.t("balance.你完成了%{value}个订单",{value:u}),this.rewardMoney=r,this.lbGetNormal.string=vt.formatMoney(r),this.lbGetMulti.string=vt.formatMoney(3*r),o&&pe.instance.playSound(ve.AUDIO_SOUND.WIN),Wn.updateRewardIcon(ve.SHARE_FUNCTION.BALANCE,this.spIcon);var h=Math.floor(100*Math.random());this.nodeDouble.active=h<30},n.onBtnGetNormalClick=function(){this.rewardOver(this.rewardMoney)},n.onBtnGetMultiClick=function(){var e=this;Wn.openReward(ve.SHARE_FUNCTION.BALANCE,(function(t){t||e.rewardOver(3*e.rewardMoney)}))},n.rewardOver=function(e){this.isFinishLevel?(Wn.finishBuyTask(ve.BUY_CAR_TYPE.PASS_LEVEL,Gt.instance.playerInfo.level,!1),Gt.instance.passLevel(e)):Gt.instance.updatePlayerInfo("gold",e),e>0&&Wn.showFlyReward(ve.REWARD_TYPE.GOLD,(function(){ue.dispatchEvent("updateGold")})),gn.instance.hideDialog("fight/balance"),Gt.instance.playerInfo.level,Gt.instance.isComeFromBalance=!1,ue.dispatchEvent("newLevel",this.isFinishLevel)},t}(T)).prototype,"spStart",[Rl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Yl=K(Ul.prototype,"spEnd",[Tl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Vl=K(Ul.prototype,"lbCurLevel",[El],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Hl=K(Ul.prototype,"lbTargetLevel",[Sl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Wl=K(Ul.prototype,"wgMenu",[Pl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),jl=K(Ul.prototype,"progress",[_l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ql=K(Ul.prototype,"imgLevelFinished",[Al],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xl=K(Ul.prototype,"imgLevelUnfinished",[Dl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Kl=K(Ul.prototype,"imgProgressNoActive",[Ol],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Zl=K(Ul.prototype,"imgProgressActive",[Nl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Jl=K(Ul.prototype,"imgProgressFinished",[Ml],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ql=K(Ul.prototype,"lbTakeCount",[Ll],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$l=K(Ul.prototype,"lbGetNormal",[kl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ec=K(Ul.prototype,"lbGetMulti",[Bl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tc=K(Ul.prototype,"spIcon",[Gl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),nc=K(Ul.prototype,"nodeDouble",[Fl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),zl=Ul));e._RF.pop(),e._RF.push({},"c2ee7NzXEdG1Z3CXlfjoO8M","en",void 0),window.i18nConfig||(window.i18nConfig={}),window.i18nConfig.languages||(window.i18nConfig.languages={}),window.i18nConfig.languages.en={main:{dataLoading:"Data loading...",dataLoadOver:"Data loading completed...",loginSuccess:"Login success...",gameResourceLoading:"Game Resource Loading...",audioResourceLoading:"Audio Resource Loading...",mappingResourceLoading:"Mapping resource loading...",modelResourceLoading:"Model resource loading...",entering:"Entering..."},mainUI:{start:"Click screen to start",changeCar:"Change cars"},shop:{btnClose:"Close",go:"Go",acquired:"Acquired",current:"Current",receive:"Receive",getGold:"Gold coins for watching AD"},balance:{"你完成了%{value}个订单":"Complete %{value} order",youEarnedIt:"You earned it",clickReceive:"Click revive",receiveImmediately:"Receive Now"},carTask:{"初始车辆":"Initial vehicle","分享获得":"Share gain","签到获得":"Signin gain","通过关卡获得":"Get through a checkpoint"},signin:{title:"Sign in on the 7th",notYet:"Not yet",normalReceive:"Normal receive",receive:"Receive",doubleReceive:"Double receive",fillSignin:"Fill signin"},fightManager:{loadingMap:"Loading map...",buildingCity:"Start building cities...",cityLoadOver:"City loaded..."},fightMap:{trimTheGround:"The ground is being trimmed...",pavingTheRoad:"Paving the way...",plantingTree:"The trees are being planted...",decorateHouse:"The house is being renovated...",paintLandmarks:"The landmark is being painted..."},online:{close:"Close",clickReceive:"Click receive",dailyIncome:"Daily income is available"},lottery:{title:"Wheel of fortune",free:"Free"},talk:{"你好,请到街对面接我.":"Hello, please meet me across the street.","停车!停车!":"Stop the car, please! Stop the car, please!","去消费最高的地方.":"Go to the place where you spend the most.","去附近的希尔顿酒店.":"Go to the nearby hilton hotel.","司机快来!我老婆要生了!":"Driver, come on!  My wife is having a baby!","大哥快点,我赶时间.":"Eldest brother hurry up, I'm in a hurry.","师傅,5分钟内能到吗?":"Master, can you be there in 5 minutes?","师傅,你是老司机嘛?":"Master, are you an old driver?","师傅,你跑一天能赚多少?":"Master, how much do you earn per day?","师傅快点,我要赶飞机.":"Master, hurry up, I have to catch the plane.","师傅跟上那辆法拉利.":"Master, keep up with that Ferrari.","带我去最近的银行.":"Take me to the nearest bank.","帮我跟上前面那辆车!":"Help me keep up with the car in front!","快去火车站,我赶车!":"Go to the railway station, I'll catch the bus!","我在酒店大堂门口等你.":"I'll wait for you at the gate of the hotel lobby.","要下雨了,你快来!":"It's going to rain, you come quickly!"},showReward:{title:"Reward",normalReceive:"Normal receive",ReceiveImmediately:" Receive Now",doubleReceive:"Double receive",alreadyHadCar:"You already own the vehicle and automatically convert it into the corresponding gold coin.",buySuccessful:"Buy successful",confrim:"Confrim",signinReward:"Signin reward"},revive:{reviveImmediately:"Resurrection Now",skip:"Skip",tips:"It's a pity that we came close to the finish line.!",continue:"Resurrection continues."},clickBox:{title:"Mysterious gift",progress:"The faster you click, the more rewards you will receive.",clickMe:"click me fast",normalReceive:"Normal receive",doubleReceive:"Double receive"},trial:{title:"Free trial",tryItNow:"Try It Now",giveUp:"Give up the trial and start the game."},invinceible:{title:"Invincible start",confirm:"Confrim",close:"Close"},setting:{title:"Setting",version:"Version:",close:"Close"}},e._RF.pop(),e._RF.push({},"c4c1axXN+NL4oYQEr2M4qn2","LocalizedLabel",void 0);var fc,dc,gc,vc,yc,mc,bc,Ic=t.ccclass,Cc=t.property;Ic("LocalizedLabel")((uc=lc=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return H(q(t=e.call.apply(e,[this].concat(i))||this),"_debouncedUpdateLabel",null),H(q(t),"label",null),X(q(t),"_dataID",sc,q(t)),t}W(t,e);var n=t.prototype;return n.onLoad=function(){Gi.inst||Gi.init(),i("dataID: "+this.dataID+" value: "+Gi.t(this.dataID)),this.fetchRender()},n.fetchRender=function(){var e=this.getComponent(P);if(e)return this.label=e,void this.updateLabel()},n.updateLabel=function(){this.label?Gi.t(this.dataID,{})&&(this.label.string=Gi.t(this.dataID,{})):r("Failed to update localized label, label component is invalid!")},n.debounce=function(e,t,n){var i=arguments,r=this,o=-1;return function(){var a=i,s=function(){o=-1,n||e.apply(r,a)}.bind(r),l=n&&!o;clearTimeout(o),o=setTimeout(s,t),l&&e.apply(r,a)}.bind(this)},V(t,[{key:"dataID",get:function(){return this._dataID},set:function(e){this._dataID!==e&&(this._dataID=e,this.updateLabel())}}]),t}(T),H(lc,"editor",{executeInEditMode:!0,menu:"i18n/LocalizedLabel"}),sc=K((ac=uc).prototype,"_dataID",[Cc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),K(ac.prototype,"dataID",[Cc],Object.getOwnPropertyDescriptor(ac.prototype,"dataID"),ac.prototype),oc=ac));e._RF.pop(),e._RF.push({},"c5aa7IsWr5A4blPeFPanXM/","main",void 0);var wc=t.ccclass,Rc=t.property;Gi.init("zh");var Tc,Ec,Sc,Pc,_c,Ac,Dc;fc=wc("main"),dc=Rc(P),gc=Rc(Cl),fc((mc=K((yc=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"lbVersion",mc,q(t)),X(q(t),"loadingUI",bc,q(t)),H(q(t),"retryTimes",0),H(q(t),"uid",""),H(q(t),"curProgress",0),H(q(t),"isLoginFinished",!1),H(q(t),"isSubPackageFinished",!1),H(q(t),"isConfigLoaded",!1),t}W(t,e);var n=t.prototype;return n.start=function(){var e=this;this.loadingUI.show(),Gt.instance.syncServerTime(Date.now()),this.curProgress=5,this.loadingUI.updateProgress(this.curProgress,Gi.t("main.dataLoading")),Dt.instance.loadConfig((function(){e.lbVersion.string="Version. "+Dt.instance.getVersion(),e.isConfigLoaded=!0,e.loadMainScene()})),this.curProgress+=5,this.loadingUI&&this.loadingUI.updateProgress(this.curProgress,Gi.t("main.dataLoadOver")),this.curProgress+=5,this.curProgress+=15,this.loadingUI.updateProgress(this.curProgress,Gi.t("main.gameResourceLoading")),Gt.instance.loadGlobalCache(),Gt.instance.userId?this.uid=Gt.instance.userId:this.uid=$.generateGuestAccount(),this.startLogin(),this.downloadGameRes((function(){console.log("subpackage download finished!"),e.isSubPackageFinished=!0,e.loadMainScene()}))},n.startLogin=function(){$.instance.setUserId(this.uid),Gt.instance.syncServerTime(Date.now()),this.userLogin()},n.userLogin=function(){Gt.instance.loadFromCache(),void 0===Gt.instance.playerInfo.createDate&&Gt.instance.createPlayerInfo(),console.log("login finished!"),this.isLoginFinished=!0,this.loadMainScene()},n.downloadGameRes=function(e){this.curProgress+=15,this.loadingUI.updateProgress(this.curProgress),e&&e()},n.showSubPackageError=function(){},n.loadGameSubPackage=function(e){var t=this;this.loadingUI.updateProgress(this.curProgress,Gi.t("main.audioResourceLoading")),h.loadBundle("resources",(function(n){if(t.curProgress+=5,t.loadingUI.updateProgress(t.curProgress,Gi.t("main.audioResourceLoading")),n)return t.showSubPackageError(),console.error(n);h.loadBundle("textures",(function(n){if(t.curProgress+=5,t.loadingUI.updateProgress(t.curProgress,Gi.t("main.mappingResourceLoading")),n)return t.showSubPackageError(),console.error(n);h.loadBundle("model",(function(n){if(t.curProgress+=5,t.loadingUI.updateProgress(t.curProgress,Gi.t("main.modelResourceLoading")),n)return t.showSubPackageError(),console.error(n);e&&e()}))}))}))},n.loadMainScene=function(){var e=this;this.isConfigLoaded&&this.isLoginFinished&&this.isSubPackageFinished&&N.preloadScene("main",(function(t){e.curProgress+=5,e.loadingUI.updateProgress(e.curProgress,Gi.t("main.entering")),t||N.loadScene("main",(function(){}))}))},t}(T)).prototype,"lbVersion",[dc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),bc=K(yc.prototype,"loadingUI",[gc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),vc=yc));e._RF.pop(),e._RF.push({},"cf371ivOc1Ae64t3ScAzqjv","effectManager",void 0);var Oc,Nc,Mc,Lc,kc,Bc,Gc,Fc,zc,Uc,xc,Yc,Vc,Hc,Wc,jc,qc,Xc,Kc,Zc,Jc,Qc,$c,eu,tu,nu,iu,ru,ou,au=t.ccclass,su=t.property,lu=(Tc=au("effectManager"),Ec=su({type:a}),Sc=su({type:Yt}),Tc((Ac=K((_c=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"pfTailLine",Ac,q(t)),X(q(t),"carManager",Dc,q(t)),H(q(t),"currentNode",null),t}W(t,e);var n=t.prototype;return n.start=function(){},n.onEnable=function(){ue.on("startBraking",this.onBrakingStart,this),ue.on("endBraking",this.onBrakingEnd,this)},n.onDisable=function(){ue.off("startBraking",this.onBrakingStart,this),ue.off("endBraking",this.onBrakingEnd,this)},n.onBrakingStart=function(){this.currentNode=Pe.instance.getNode(this.pfTailLine,this.node),this.currentNode.setWorldPosition(this.carManager.mainCar.node.worldPosition),this.currentNode.eulerAngles=this.carManager.mainCar.node.eulerAngles,pe.instance.playSound(ve.AUDIO_SOUND.STOP)},n.onBrakingEnd=function(){var e=this.currentNode;this.currentNode=null,this.scheduleOnce((function(){e&&e.isValid&&Pe.instance.putNode(e)}),2)},n.update=function(e){this.currentNode&&this.carManager.mainCar&&(this.currentNode.setWorldPosition(this.carManager.mainCar.node.worldPosition),this.currentNode.eulerAngles=this.carManager.mainCar.node.eulerAngles)},n.reset=function(){if(this.currentNode){Pe.instance.putNode(this.currentNode),Pe.instance.clearPool(this.currentNode.name),this.currentNode=null;for(var e=this.node.children.slice(0),t=0;t<e.length;t++){var n=e[t];n&&n.isValid&&n.destroy()}}},t}(T)).prototype,"pfTailLine",[Ec],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Dc=K(_c.prototype,"carManager",[Sc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pc=_c))||Pc);e._RF.pop(),e._RF.push({},"d7ed7RMvvZIvbdJyWwfIGDy","lottery",void 0);var cu,uu,hu,pu,fu,du,gu,vu,yu,mu,bu,Iu=t.ccclass,Cu=t.property;Oc=Iu("lottery"),Nc=Cu(m),Mc=Cu(a),Lc=Cu(m),kc=Cu(m),Bc=Cu(M),Gc=Cu(M),Fc=Cu(P),zc=Cu(c),Uc=Cu(c),xc=Cu(c),Yc=Cu(D),Vc=Cu(D),Hc=Cu(D),Oc((qc=K((jc=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"arrRewardNode",qc,q(t)),X(q(t),"pfRewardItem",Xc,q(t)),X(q(t),"nodeTurnable",Kc,q(t)),X(q(t),"ndBtnClose",Zc,q(t)),X(q(t),"btnLottery",Jc,q(t)),X(q(t),"btnAd",Qc,q(t)),X(q(t),"lbMoney",$c,q(t)),X(q(t),"imgLotteryBtnDisable",eu,q(t)),X(q(t),"imgLotteryBtnEnable",tu,q(t)),X(q(t),"imgAdBtnEnable",nu,q(t)),X(q(t),"spLotteryBtn",iu,q(t)),X(q(t),"spAdIcon",ru,q(t)),X(q(t),"spAdBtn",ou,q(t)),H(q(t),"arrRewardData",[]),H(q(t),"arrLotteryItem",[]),H(q(t),"arrProbability",[]),H(q(t),"randValue",0),H(q(t),"curRotation",null),H(q(t),"_receiveCarTimes",0),t}W(t,e);var n=t.prototype;return n.start=function(){},n.onEnable=function(){ue.on("buyCar",this.onBuyCar,this)},n.onDisable=function(){ue.off("buyCar",this.onBuyCar,this)},n.onBuyCar=function(){this.initReward()},n.show=function(){this.initReward(),this.initInfo(),this.btnAd.node.active=!0},n.initReward=function(){var e=Dt.instance.getCars(),t=[];if(e.forEach((function(e){Gt.instance.hasCar(e.ID)||e.type!==ve.BUY_CAR_TYPE.GOLD||t.push(e.ID)})),t.length<6)for(var n=hs.cloneDeep(Gt.instance.playerInfo.cars);t.length<6;){var i=Math.floor(Math.random()*n.length),r=n[i];Dt.instance.queryByID("car",r).type===ve.BUY_CAR_TYPE.GOLD&&t.push(n.splice(i,1)[0])}this.arrRewardData=t,this.arrProbability=[];for(var o=0,a=0;a<this.arrRewardNode.length;a++){var l=this.arrRewardNode[a],c=this.arrLotteryItem[a];if(c||((c=s(this.pfRewardItem)).parent=l,this.arrLotteryItem[a]=c),this.arrRewardData.length>a){var u=this.arrRewardData[a];c.getComponent(Rs).show(u);var h=o,p=o+100/6;this.arrProbability.push({min:h,max:p,idx:a}),o=p}}},n.initInfo=function(){this.lbMoney.string=""+ve.LOTTERY.MONEY,this.checkButton()},n.checkButton=function(){var e=this.checkIsFree();this.btnAd.node.active=e,this.btnLottery.node.active=!e,e||(Gt.instance.playerInfo.gold>ve.LOTTERY.MONEY?(this.lbMoney.color=new L(163,64,27),this.lotteryBtnEnable=!0,this.adBtnEnable=!1):(this.lbMoney.color=L.RED,this.lotteryBtnEnable=!1,this.adBtnEnable=!0),Wn.updateRewardIcon(ve.SHARE_FUNCTION.LOTTERY,this.spAdIcon,(function(){})))},n.checkIsFree=function(){var e=Gt.instance.playerInfo.signInInfo.currentDay,t=$.instance.getGlobalData("rewardDays");return void 0===t||parseInt(t)<e},n.getRandValue=function(){for(var e=-1;-1===e;)for(var t=Math.floor(100*Math.random()),n=0;n<this.arrProbability.length;n++){var i=this.arrProbability[n];if(t>=i.min&&t<i.max){e=i.idx;break}}return e},n.onBtnStartClick=function(){Wn.addGold(-ve.LOTTERY.MONEY),this.startRun()},n.onBtnAdClick=function(){var e=this,t=$.instance.getGlobalData("rewardDays");$.instance.setGlobalData("rewardDays",""+(t?parseInt(t)+1:0)),Wn.openReward(ve.SHARE_FUNCTION.LOTTERY,(function(t){t||e.startRun()}))},n.startRun=function(){var e=this;this.lotteryBtnEnable=!1,this.adBtnEnable=!1,this.ndBtnClose.getComponent(M).interactable=!1,this.randValue=this.getRandValue();var t=this.nodeTurnable.eulerAngles.z%360;this.nodeTurnable.eulerAngles=new b(0,0,t);var n=360-t,i=3+Math.floor(4*Math.random()),r=-360-360*i+60*this.randValue+30-360;this.curRotation=this.nodeTurnable.eulerAngles.clone(),A(this.curRotation).to(n/360+.5*i,new b(0,0,r),{easing:"cubicOut"}).call((function(){e.curRotation=null,e.showReward()})).start()},n.showReward=function(){this.ndBtnClose.getComponent(M).interactable=!0,this.arrLotteryItem[this.randValue].getComponent(Rs).showReward(this),this.checkButton()},n.onBtnCloseClick=function(){gn.instance.hideDialog("lottery/lottery")},n.update=function(e){this.curRotation&&(this.nodeTurnable.eulerAngles=this.curRotation)},V(t,[{key:"receiveCarTimes",get:function(){return this._receiveCarTimes},set:function(e){console.log("#####receiveCarTimes",e),this._receiveCarTimes=e}},{key:"lotteryBtnEnable",set:function(e){e?(this.btnLottery.interactable=!0,this.spLotteryBtn.spriteFrame=this.imgLotteryBtnEnable):(this.btnLottery.interactable=!1,this.spLotteryBtn.spriteFrame=this.imgLotteryBtnDisable)}},{key:"adBtnEnable",set:function(e){e?(this.btnAd.interactable=!0,this.spAdBtn.spriteFrame=this.imgAdBtnEnable):(this.btnAd.interactable=!1,this.spAdBtn.spriteFrame=this.imgLotteryBtnDisable)}}]),t}(T)).prototype,"arrRewardNode",[Nc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Xc=K(jc.prototype,"pfRewardItem",[Mc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Kc=K(jc.prototype,"nodeTurnable",[Lc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Zc=K(jc.prototype,"ndBtnClose",[kc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Jc=K(jc.prototype,"btnLottery",[Bc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qc=K(jc.prototype,"btnAd",[Gc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$c=K(jc.prototype,"lbMoney",[Fc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),eu=K(jc.prototype,"imgLotteryBtnDisable",[zc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tu=K(jc.prototype,"imgLotteryBtnEnable",[Uc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),nu=K(jc.prototype,"imgAdBtnEnable",[xc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),iu=K(jc.prototype,"spLotteryBtn",[Yc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ru=K(jc.prototype,"spAdIcon",[Vc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ou=K(jc.prototype,"spAdBtn",[Hc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Wc=jc));e._RF.pop(),e._RF.push({},"daea1EBoy1Ms6PBdAupQWnn","fightCanvas",void 0);var wu=t.ccclass,Ru=t.property,Tu=(cu=wu("fightCanvas"),uu=Ru(Yt),hu=Ru(c),pu=Ru(c),fu=Ru(Cl),cu((vu=K((gu=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"carManager",vu,q(t)),X(q(t),"imgShare",yu,q(t)),X(q(t),"imgVideo",mu,q(t)),X(q(t),"loadingUI",bu,q(t)),H(q(t),"curProgress",50),H(q(t),"isFirstLoad",!0),H(q(t),"isTouching",!1),t}W(t,e);var n=t.prototype;return n.start=function(){Wn.imgAd=this.imgVideo,Wn.imgShare=this.imgShare,this.loadingUI.show(this.curProgress),this.node.on(m.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(m.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(m.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},n.onEnable=function(){ue.on("updateLoading",this.updateLoadingProgress,this),ue.on("showGuide",this.showGuide,this)},n.onDisable=function(){ue.off("updateLoading",this.updateLoadingProgress,this),ue.off("showGuide",this.showGuide,this)},n.onTouchStart=function(){this.isTouching=!0,this.carManager.controlMainCar(!0)},n.onTouchEnd=function(){this.isTouching=!1,this.carManager.controlMainCar(!1)},n.showGuide=function(e){var t=this;e&&this.isTouching&&this.scheduleOnce((function(){t.onTouchStart()}),0)},n.updateLoadingProgress=function(e,t){this.isFirstLoad?this.curProgress+=Math.floor(e/2):this.curProgress+=e,this.loadingUI.updateProgress(this.curProgress,t)},n.loadNewLevel=function(){this.loadingUI.node.active=!0,this.curProgress=0,this.isFirstLoad=!1},n.finishLoading=function(){this.loadingUI.node.active=!1},t}(T)).prototype,"carManager",[uu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),yu=K(gu.prototype,"imgShare",[hu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mu=K(gu.prototype,"imgVideo",[pu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),bu=K(gu.prototype,"loadingUI",[fu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),du=gu))||du);e._RF.pop(),e._RF.push({},"e88543KyK5I1IU1Sy8u4Lzm","migrate-canvas",void 0);var Eu=1048575;function Su(e,t){for(var n=0,i=e.children.length;n<i;n++)e.children[n].layer=t,Su(e.children[n],t)}N.on(z.EVENT_AFTER_SCENE_LAUNCH,(function(){var e,t,n,i=null===(e=N.getScene())||void 0===e?void 0:e.children,r=null===(t=N.getScene())||void 0===t?void 0:t.getComponentsInChildren(U);if(!(r.length<=1)){r=r.filter((function(e){return!!e.cameraComponent}));var o=null===(n=N.getScene())||void 0===n?void 0:n.getComponentsInChildren(x),a=0;o.forEach((function(e){return a|=e.visibility&Eu}));for(var s=[],l=0,c=i.length;l<c;l++){var u=i[l];if(F.isPersistRootNode(u)){var h=u.getComponentsInChildren(U);0!==h.length&&s.push.apply(s,h.filter((function(e){return!!e.cameraComponent})))}}s.forEach((function(e){if(r.find((function(t){return t!==e&&t.cameraComponent.visibility&e.cameraComponent.visibility&Eu}))){var t=~a,n=t&~(t-1);e.cameraComponent.visibility=n|4293918720&e.cameraComponent.visibility,Su(e.node,n),a|=t}}))}}));var Pu,_u,Au,Du,Ou,Nu,Mu,Lu,ku,Bu=cc.Node.prototype.setParent;function Gu(e){var t=null,n=e.getComponent(U);return n&&n.cameraComponent?t=n.cameraComponent.visibility&n.node.layer?n.node.layer:n.cameraComponent.visibility&~(n.cameraComponent.visibility-1):(e.parent&&(t=Gu(e.parent)),t)}cc.Node.prototype.setParent=function(e,t){if(Bu.call(this,e,t),e){var n=Gu(this);n&&(this.layer=n,Su(this,n))}},e._RF.pop(),e._RF.push({},"ec04bogempOHrQhVVHVqSZV","invincible",void 0);var Fu,zu,Uu,xu,Yu,Vu,Hu,Wu,ju,qu,Xu,Ku,Zu,Ju=t.ccclass,Qu=t.property;Pu=Ju("invincible"),_u=Qu(m),Au=Qu(k),Du=Qu(D),Pu((Mu=K((Nu=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"nodeCarParent",Mu,q(t)),X(q(t),"wgMenu",Lu,q(t)),X(q(t),"spIcon",ku,q(t)),H(q(t),"_callback",void 0),H(q(t),"currentCar",null),t}W(t,e);var n=t.prototype;return n.start=function(){},n.show=function(e){var t=this;this._callback=e,Wn.updateRewardIcon(ve.SHARE_FUNCTION.INVINCIBLE,this.spIcon,(function(e,t){})),this.currentCar&&(Pe.instance.putNode(this.currentCar),this.currentCar=null);var n=Dt.instance.queryByID("car",Gt.instance.showCar.toString());he.getUICar(n.model,(function(e,i){e?console.error(e,n.model):t.currentCar=Pe.instance.getNode(i,t.nodeCarParent)}))},n.onBtnCloseClick=function(){gn.instance.hideDialog("main/invincible"),this._callback&&this._callback()},n.onBtnOKClick=function(){var e=this;Wn.openReward(ve.SHARE_FUNCTION.INVINCIBLE,(function(t,n){t||(ue.dispatchEvent("showInvincible"),e.onBtnCloseClick())}))},t}(T)).prototype,"nodeCarParent",[_u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Lu=K(Nu.prototype,"wgMenu",[Au],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ku=K(Nu.prototype,"spIcon",[Du],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ou=Nu));e._RF.pop(),e._RF.push({},"f130br9GwZGkJEkRGonhXxR","btnAdapter",void 0);var $u,eh,th,nh,ih,rh,oh,ah,sh,lh,ch,uh,hh,ph,fh,dh=t.ccclass,gh=t.property,vh=t.menu,yh=t.requireComponent,mh=t.disallowMultiple;Fu=dh("btnAdapter"),zu=vh("自定义组件/btnAdapter"),Uu=yh(M),xu=gh({tooltip:"点击后是否播放点击音效"}),Yu=gh({tooltip:"点击音效名"}),Vu=gh({tooltip:"是否禁止快速二次点击"}),Hu=gh({tooltip:"点击后多久才能再次点击,仅isPreventSecondClick为true生效"}),Fu(Wu=zu(Wu=Uu(Wu=mh((qu=K((ju=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"isPlaySound",qu,q(t)),X(q(t),"clickSoundName",Xu,q(t)),X(q(t),"isPreventSecondClick",Ku,q(t)),X(q(t),"preventTime",Zu,q(t)),t}return W(t,e),t.prototype.start=function(){var e=this,t=this.node.getComponent(M);this.node.on("click",(function(){e.isPreventSecondClick&&(t.interactable=!1,e.scheduleOnce((function(){t.node&&(t.interactable=!0)}),e.preventTime)),e.isPlaySound&&pe.instance.playSound(e.clickSoundName,!1)}))},t}(T)).prototype,"isPlaySound",[xu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Xu=K(ju.prototype,"clickSoundName",[Yu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"click"}}),Ku=K(ju.prototype,"isPreventSecondClick",[Vu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Zu=K(ju.prototype,"preventTime",[Hu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),Wu=ju))||Wu)||Wu)||Wu);e._RF.pop(),e._RF.push({},"f3d36qkNslPB4TIGcZlp8vd","fightManager",void 0);var bh,Ih,Ch,wh,Rh,Th,Eh,Sh,Ph,_h,Ah,Dh,Oh,Nh,Mh,Lh,kh,Bh,Gh,Fh,zh,Uh,xh,Yh,Vh,Hh,Wh,jh,qh,Xh,Kh,Zh,Jh,Qh,$h,ep,tp,np,ip,rp,op,ap,sp,lp,cp,up=t.ccclass,hp=t.property;$u=up("fightManager"),eh=hp(Tu),th=hp({type:$i}),nh=hp({type:io}),ih=hp({type:Yt}),rh=hp({type:lu}),oh=hp({type:m,displayName:"地面"}),$u((lh=K((sh=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return X(q(t=e.call.apply(e,[this].concat(i))||this),"fightLoading",lh,q(t)),X(q(t),"mapManager",ch,q(t)),X(q(t),"customerManager",uh,q(t)),X(q(t),"carManager",hh,q(t)),X(q(t),"effectManager",ph,q(t)),X(q(t),"nodeGround",fh,q(t)),H(q(t),"isStart",!1),H(q(t),"isOver",!1),H(q(t),"isFinishedLevel",!1),H(q(t),"money",0),H(q(t),"curLevel",0),H(q(t),"hasRevive",!1),t}W(t,e);var n=t.prototype;return n.start=function(){var e=this;this.initGround(),this.loadMap((function(){e.initCar(),e.loadCar()}))},n.onEnable=function(){ue.on("startGame",this.startGame,this),ue.on("takeCustomer",this.onTakeCustomer,this),ue.on("gameOver",this.gameOver,this),ue.on("newLevel",this.newLevel,this),ue.on("updateCar",this.updateMainCar,this),ue.on("revive",this.revive,this)},n.onDisable=function(){ue.off("startGame",this.startGame,this),ue.off("takeCustomer",this.onTakeCustomer,this),ue.off("gameOver",this.gameOver,this),ue.off("newLevel",this.newLevel,this),ue.off("updateCar",this.updateMainCar,this),ue.off("revive",this.revive,this)},n.initGround=function(){var e=this.nodeGround.getComponent(w);e.setGroup(ie.CAR_GROUP.NORMAL),e.setMask(-1)},n.loadMap=function(e){var t=this,n=1;Gt.instance.playerInfo&&(console.log("###playerData.instance.playerInfo.realLevel;",Gt.instance.playerInfo.realLevel),n=Gt.instance.playerInfo.passCheckPoint?Gt.instance.playerInfo.realLevel||n:Gt.instance.playerInfo.level||n,console.log("###level",n)),this.curLevel=n,console.log("load level "+this.curLevel);var i=this.curLevel>100?this.curLevel:this.curLevel+100;ue.dispatchEvent("updateLoading",4,Gi.t("fightManager.loadingMap")),he.getMap(i,(function(n,i){n?console.error(n):(ue.dispatchEvent("updateLoading",10,Gi.t("fightManager.buildingCity")),t.mapManager.buildMap(i,(function(){}),(function(){ue.dispatchEvent("updateLoading",6,Gi.t("fightManager.cityLoadOver")),e&&e()})))}))},n.initCar=function(){this.carManager.init(this.mapManager,this.customerManager)},n.reset=function(){this.carManager.reset(),this.customerManager.reset(),this.effectManager.reset(),this.isStart=!1,this.isOver=!1,this.isFinishedLevel=!1,this.money=0,this.hasRevive=!1,this.loadCar()},n.loadCar=function(){var e=this;this.carManager.preloadAICar((function(){e.fightLoading.finishLoading(),e.showMainUI()}))},n.startGame=function(){this.isStart||(this.isStart=!0,this.carManager.startGame(),this.showFightUI())},n.gameOver=function(e){this.isOver||(this.isFinishedLevel=e,this.isOver=!0,this.carManager.gameOver(),this.showBalanceUI())},n.onTakeCustomer=function(){var e=this,t=Math.floor(30+this.curLevel/2+Math.floor(10*Math.random()));this.money+=t,ue.dispatchEvent("makeMoney",t),he.getEffect("coin",(function(t,n){t&&console.error(t);var i=s(n);i.parent=e.node,e.carManager.mainCar&&i.setWorldPosition(e.carManager.mainCar.node.getWorldPosition()),e.scheduleOnce((function(){i.destroy()}),2)}))},n.showMainUI=function(){gn.instance.showDialog("main/mainUI")},n.showFightUI=function(){gn.instance.hideDialog("main/mainUI"),gn.instance.showDialog("fight/fightUI",[this])},n.showBalanceUI=function(){var e=this.carManager.getCurrentProgress();gn.instance.showDialog("fight/balance",[Gt.instance.playerInfo.level,e.cur,e.isOver,this.mapManager.levelProgressCnt,this.money,this.isFinishedLevel])},n.newLevel=function(e){var t=this;this.fightLoading.loadNewLevel(),gn.instance.hideDialog("fight/fightUI"),this.hasRevive=!1,e?(this.mapManager.recycle(),this.loadMap((function(){t.reset()}))):this.reset()},n.updateMainCar=function(){this.carManager.creatMainCar()},n.revive=function(){this.carManager.revive()},t}(T)).prototype,"fightLoading",[eh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ch=K(sh.prototype,"mapManager",[th],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),uh=K(sh.prototype,"customerManager",[nh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),hh=K(sh.prototype,"carManager",[ih],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ph=K(sh.prototype,"effectManager",[rh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fh=K(sh.prototype,"nodeGround",[oh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ah=sh));e._RF.pop(),e._RF.push({},"fb9b7V8bZND35IgNyATVMNv","fightUI",void 0);var pp=t.ccclass,fp=t.property;bh=pp("fightUI"),Ih=fp(D),Ch=fp(D),wh=fp({type:P}),Rh=fp({type:P}),Th=fp({type:m,displayName:"进度项"}),Eh=fp(m),Sh=fp(P),Ph=fp(P),_h=fp(D),Ah=fp(c),Dh=fp(c),Oh=fp(c),Nh=fp(c),Mh=fp(c),Lh=fp(O),kh=fp(m),Bh=fp(D),Gh=fp(c),Fh=fp(c),zh=fp(c),Uh=fp(c),bh((Vh=K((Yh=function(e){function t(){var t;return X(q(t=e.call(this)||this),"spStart",Vh,q(t)),X(q(t),"spEnd",Hh,q(t)),X(q(t),"curLevel",Wh,q(t)),X(q(t),"targetLevel",jh,q(t)),X(q(t),"progress",qh,q(t)),X(q(t),"nodeTalk",Xh,q(t)),X(q(t),"lbTalk",Kh,q(t)),X(q(t),"lbMake",Zh,q(t)),X(q(t),"spHead",Jh,q(t)),X(q(t),"imgLevelFinished",Qh,q(t)),X(q(t),"imgLevelUnfinished",$h,q(t)),X(q(t),"imgProgressNoActive",ep,q(t)),X(q(t),"imgProgressActive",tp,q(t)),X(q(t),"imgProgressFinished",np,q(t)),X(q(t),"aniMakeMoney",ip,q(t)),X(q(t),"nodeGuide",rp,q(t)),H(q(t),"fightManager",null),H(q(t),"carManager",null),X(q(t),"spShowGuideTip",op,q(t)),X(q(t),"img01",ap,q(t)),X(q(t),"img02",sp,q(t)),X(q(t),"img01En",lp,q(t)),X(q(t),"img02En",cp,q(t)),H(q(t),"isShowGuide",!1),H(q(t),"showGuideTime",0),t}W(t,e);var n=t.prototype;return n.start=function(){},n.onEnable=function(){ue.on("greetingCustomer",this.updateCarProgress,this),ue.on("takeCustomer",this.updateCarProgress,this),ue.on("gameOver",this.updateCarProgress,this),ue.on("showTalk",this.showCustomerTalk,this),ue.on("makeMoney",this.onMakeMoney,this),ue.on("showGuide",this.showGuide,this)},n.onDisable=function(){ue.off("greetingCustomer",this.updateCarProgress,this),ue.off("takeCustomer",this.updateCarProgress,this),ue.off("gameOver",this.updateCarProgress,this),ue.off("showTalk",this.showCustomerTalk,this),ue.off("makeMoney",this.onMakeMoney,this),ue.off("showGuide",this.showGuide,this)},n.onTouchStart=function(){this.nodeGuide.getComponent(O).stop(),this.nodeGuide.active=!1},n.show=function(e){this.fightManager=e,this.carManager=this.fightManager.carManager,this.refreshUI(),this.carManager.mainCar.isMoving||this.showGuide(!0)},n.showGuide=function(e){this.nodeGuide.active=e;var t=this.nodeGuide.getComponent(O);e?t.play():t.stop(),e?(this.isShowGuide=!0,this.showGuideTime=0,t.getState("showGuide").setTime(0)):(this.isShowGuide=!1,this.showGuideTime=0)},n.onBtnAgainClick=function(){ue.dispatchEvent("newLevel",!1)},n.onBtnChangeCameraRotation=function(){this.carManager.changeCameraFollowRotation()},n.refreshUI=function(){for(var e=this.fightManager.mapManager.levelProgressCnt,t=0;t<e;t++)this.progress[t].active=!0,this.progress[t].getComponent(D).spriteFrame=this.imgProgressNoActive;for(var n=e;n<this.progress.length;n++)this.progress[n].active=!1;var i=Gt.instance.playerInfo?Gt.instance.playerInfo.level:1;this.curLevel.string=""+i,this.targetLevel.string=""+(i+1),this.spStart.spriteFrame=this.imgLevelFinished,this.spEnd.spriteFrame=this.imgLevelUnfinished},n.updateCarProgress=function(){for(var e=this.carManager.getCurrentProgress(),t=e.cur,n=e.isOver?t:t-1,i=0;i<n;i++)this.progress[i].getComponent(D).spriteFrame=this.imgProgressFinished;e.isOver||(this.progress[n].getComponent(D).spriteFrame=this.imgProgressActive),this.fightManager.isFinishedLevel&&(this.spEnd.spriteFrame=this.imgLevelFinished)},n.showCustomerTalk=function(e,t){var n=this,i=Dt.instance.getTableArr("talk"),r=[];i.forEach((function(e){e.type===t&&r.push(e)}));var o=Math.floor(Math.random()*r.length),a=r[o];this.lbTalk.string=Gi.t("talk."+a.content),he.setCustomerIcon(e,this.spHead,(function(){})),this.nodeTalk.active=!0,this.nodeTalk.getComponent(O).play(),this.scheduleOnce((function(){n.nodeTalk.active=!1}),4)},n.onMakeMoney=function(e){var t=this;this.aniMakeMoney.node.active=!0,this.lbMake.string="+"+e,this.aniMakeMoney.play(),this.aniMakeMoney.once(O.EventType.FINISHED,(function(){t.aniMakeMoney.node.active=!1}),this)},n.update=function(e){this.isShowGuide&&(0===Math.floor(this.showGuideTime)&&("zh"===window.i18nConfig.curLang?this.spShowGuideTip.spriteFrame=this.img01:"en"===window.i18nConfig.curLang&&(this.spShowGuideTip.spriteFrame=this.img01En)),this.showGuideTime+=e,1===Math.floor(this.showGuideTime)?"zh"===window.i18nConfig.curLang?this.spShowGuideTip.spriteFrame=this.img02:"en"===window.i18nConfig.curLang&&(this.spShowGuideTip.spriteFrame=this.img02En):2===Math.floor(this.showGuideTime)&&("zh"===window.i18nConfig.curLang?this.spShowGuideTip.spriteFrame=this.img01:"en"===window.i18nConfig.curLang&&(this.spShowGuideTip.spriteFrame=this.img01En),this.showGuideTime=0))},t}(T)).prototype,"spStart",[Ih],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Hh=K(Yh.prototype,"spEnd",[Ch],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Wh=K(Yh.prototype,"curLevel",[wh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),jh=K(Yh.prototype,"targetLevel",[Rh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),qh=K(Yh.prototype,"progress",[Th],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Xh=K(Yh.prototype,"nodeTalk",[Eh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Kh=K(Yh.prototype,"lbTalk",[Sh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Zh=K(Yh.prototype,"lbMake",[Ph],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Jh=K(Yh.prototype,"spHead",[_h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qh=K(Yh.prototype,"imgLevelFinished",[Ah],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$h=K(Yh.prototype,"imgLevelUnfinished",[Dh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ep=K(Yh.prototype,"imgProgressNoActive",[Oh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tp=K(Yh.prototype,"imgProgressActive",[Nh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),np=K(Yh.prototype,"imgProgressFinished",[Mh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ip=K(Yh.prototype,"aniMakeMoney",[Lh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rp=K(Yh.prototype,"nodeGuide",[kh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),op=K(Yh.prototype,"spShowGuideTip",[Bh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ap=K(Yh.prototype,"img01",[Gh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),sp=K(Yh.prototype,"img02",[Fh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),lp=K(Yh.prototype,"img01En",[zh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),cp=K(Yh.prototype,"img02En",[Uh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xh=Yh));e._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///main.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});